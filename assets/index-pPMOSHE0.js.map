{"version":3,"file":"index-pPMOSHE0.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../src/utils/deutan-simulator.ts","../../src/components/ColorWheel.tsx","../../src/components/ColorCircles.tsx","../../src/utils/color-converter.ts","../../src/components/ColorAdjuster.tsx","../../src/utils/image-processor.ts","../../src/components/ImageUploader.tsx","../../src/components/ImageViewer.tsx","../../src/components/CameraCapture.tsx","../../src/components/AboutModal.tsx","../../src/components/ColorWheelIcon.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","// deutan_poly_full.ts\n// Machado 2009 Deuteranomaly matrices (full 0.0..1.0 step 0.1) → polynomialized (degree=4).\n// Provides: simulateDeutanPoly(), daltonizeDeutan().\n// Source for matrices: UFRGS page, Table 1 (Deuteranomaly column).\n\n// ---------- sRGB <-> linear ----------\nfunction srgbToLinear(c: number): number {\n  return (c <= 0.04045) ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);\n}\nfunction linearToSrgb(c: number): number {\n  return (c <= 0.0031308) ? 12.92 * c : 1.055 * Math.pow(c, 1/2.4) - 0.055;\n}\n\n// ---------- Linear algebra helpers ----------\ntype Vec3 = [number, number, number];\ntype Mat3 = [Vec3, Vec3, Vec3];\n\nfunction applyMat3(m: Mat3, v: Vec3): Vec3 {\n  const [x,y,z] = v;\n  return [\n    m[0][0]*x + m[0][1]*y + m[0][2]*z,\n    m[1][0]*x + m[1][1]*y + m[1][2]*z,\n    m[2][0]*x + m[2][1]*y + m[2][2]*z,\n  ];\n}\n\nfunction clamp01(x: number): number {\n  return Math.max(0, Math.min(1, x));\n}\n\nfunction clamp255(x: number): number {\n  return Math.max(0, Math.min(255, Math.round(x)));\n}\n\n// ---------- Polynomial fit (least squares) ----------\n// Fit y ≈ Σ_{k=0..d} c_k x^k\nfunction polyfitLeastSquares(xs: number[], ys: number[], degree: number): number[] {\n  if (xs.length !== ys.length) throw new Error(\"xs and ys must have the same length\");\n  const n = xs.length;\n  const d = degree;\n  if (n < d + 1) throw new Error(`Need at least degree+1 points (got ${n}, degree ${d})`);\n\n  // Build Vandermonde matrix A and vector b\n  const A: number[][] = Array.from({length: n}, () => Array(d+1).fill(0));\n  const b: number[] = ys.slice();\n\n  for (let i = 0; i < n; i++) {\n    let val = 1;\n    for (let j = 0; j <= d; j++) {\n      A[i][j] = val;\n      val *= xs[i];\n    }\n  }\n\n  // Solve normal equations (A^T A) c = A^T b via Gaussian elimination\n  const AT = transpose(A);\n  const ATA = matMul(AT, A);\n  const ATb = matVecMul(AT, b);\n\n  // Solve ATA * c = ATb\n  const c = gaussianSolve(ATA, ATb);\n  return c;\n}\n\nfunction transpose(M: number[][]): number[][] {\n  const rows = M.length, cols = M[0].length;\n  const T = Array.from({length: cols}, () => Array(rows).fill(0));\n  for (let i = 0; i < rows; i++) for (let j = 0; j < cols; j++) T[j][i] = M[i][j];\n  return T;\n}\n\nfunction matMul(A: number[][], B: number[][]): number[][] {\n  const r = A.length, k = A[0].length, c = B[0].length;\n  const out = Array.from({length: r}, () => Array(c).fill(0));\n  for (let i = 0; i < r; i++) {\n    for (let j = 0; j < c; j++) {\n      let sum = 0;\n      for (let t = 0; t < k; t++) sum += A[i][t] * B[t][j];\n      out[i][j] = sum;\n    }\n  }\n  return out;\n}\n\nfunction matVecMul(A: number[][], v: number[]): number[] {\n  const r = A.length, c = A[0].length;\n  const out = Array(r).fill(0);\n  for (let i = 0; i < r; i++) {\n    let sum = 0;\n    for (let j = 0; j < c; j++) sum += A[i][j] * v[j];\n    out[i] = sum;\n  }\n  return out;\n}\n\nfunction gaussianSolve(Ain: number[][], bIn: number[]): number[] {\n  // Augment\n  const n = Ain.length;\n  const A = Ain.map((row, i) => row.concat([bIn[i]]));\n\n  // Forward elimination\n  for (let i = 0; i < n; i++) {\n    // Pivot\n    let maxRow = i;\n    for (let r = i+1; r < n; r++) if (Math.abs(A[r][i]) > Math.abs(A[maxRow][i])) maxRow = r;\n    [A[i], A[maxRow]] = [A[maxRow], A[i]];\n\n    const pivot = A[i][i];\n    if (Math.abs(pivot) < 1e-12) throw new Error(\"Singular matrix in gaussianSolve\");\n\n    // Normalize row\n    for (let j = i; j <= n; j++) A[i][j] /= pivot;\n\n    // Eliminate\n    for (let r = 0; r < n; r++) {\n      if (r === i) continue;\n      const factor = A[r][i];\n      for (let j = i; j <= n; j++) A[r][j] -= factor * A[i][j];\n    }\n  }\n\n  // Extract solution\n  const x = A.map(row => row[n]);\n  return x;\n}\n\n// ---------- Deuteranomaly matrices from Machado2009 Table 1 ----------\ntype SamplePoint = { s: number, M: Mat3 };\n\nconst MACHADO_DEUTERANOMALY: SamplePoint[] = [\n  { s: 0.0, M: [\n    [1.000000, 0.000000, -0.000000],\n    [0.000000, 1.000000,  0.000000],\n    [-0.000000,-0.000000, 1.000000],\n  ]},\n  { s: 0.1, M: [\n    [0.866435, 0.177704, -0.044139],\n    [0.049567, 0.939063,  0.011370],\n    [-0.003453, 0.007233, 0.996220],\n  ]},\n  { s: 0.2, M: [\n    [0.760729, 0.319078, -0.079807],\n    [0.090568, 0.889315,  0.020117],\n    [-0.006027, 0.013325, 0.992702],\n  ]},\n  { s: 0.3, M: [\n    [0.675425, 0.433850, -0.109275],\n    [0.125303, 0.847755,  0.026942],\n    [-0.007950, 0.018572, 0.989378],\n  ]},\n  { s: 0.4, M: [\n    [0.605511, 0.528560, -0.134071],\n    [0.155318, 0.812366,  0.032316],\n    [-0.009376, 0.023176, 0.986200],\n  ]},\n  { s: 0.5, M: [\n    [0.547494, 0.607765, -0.155259],\n    [0.181692, 0.781742,  0.036566],\n    [-0.010410, 0.027275, 0.983136],\n  ]},\n  { s: 0.6, M: [\n    [0.498864, 0.674741, -0.173604],\n    [0.205199, 0.754872,  0.039929],\n    [-0.011131, 0.030969, 0.980162],\n  ]},\n  { s: 0.7, M: [\n    [0.457771, 0.731899, -0.189670],\n    [0.226409, 0.731012,  0.042579],\n    [-0.011595, 0.034333, 0.977261],\n  ]},\n  { s: 0.8, M: [\n    [0.422823, 0.781057, -0.203881],\n    [0.245752, 0.709602,  0.044646],\n    [-0.011843, 0.037423, 0.974421],\n  ]},\n  { s: 0.9, M: [\n    [0.392952, 0.823610, -0.216562],\n    [0.263559, 0.690210,  0.046232],\n    [-0.011910, 0.040281, 0.971630],\n  ]},\n  { s: 1.0, M: [\n    [0.367322, 0.860646, -0.227968],\n    [0.280085, 0.672501,  0.047413],\n    [-0.011820, 0.042940, 0.968881],\n  ]},\n];\n\n// ---------- Build polynomial coefficients per element ----------\ntype CoeffMat = number[][][]; // 3x3 of coefficient arrays [c0..cd]\nfunction buildPolynomialCoeffs(data: SamplePoint[], degree: number): CoeffMat {\n  if (degree < 1) throw new Error(\"degree must be >= 1\");\n  const xs = data.map(p => p.s);\n  const coeffs: CoeffMat = [[],[],[]] as unknown as CoeffMat;\n\n  for (let i = 0; i < 3; i++) {\n    coeffs[i] = [];\n    for (let j = 0; j < 3; j++) {\n      const ys = data.map(p => p.M[i][j]);\n      const c = polyfitLeastSquares(xs, ys, degree);\n      coeffs[i][j] = c; // length degree+1\n    }\n  }\n  return coeffs;\n}\n\nfunction evalPoly(c: number[], x: number): number {\n  // Horner\n  let acc = 0;\n  for (let k = c.length - 1; k >= 0; k--) acc = acc * x + c[k];\n  return acc;\n}\n\nfunction evaluateMatrix(coeffs: CoeffMat, s: number): Mat3 {\n  const ss = clamp01(s);\n  const M: Mat3 = [[0,0,0],[0,0,0],[0,0,0]] as Mat3;\n  for (let i = 0; i < 3; i++) {\n    for (let j = 0; j < 3; j++) {\n      M[i][j] = evalPoly(coeffs[i][j], ss);\n    }\n  }\n  return M;\n}\n\n// Precompute coefficients\nconst DEGREE = 4;\nconst COEFFS: CoeffMat = buildPolynomialCoeffs(MACHADO_DEUTERANOMALY, DEGREE);\n\n// ---------- Public API ----------\nexport type RGB8 = [number, number, number];\n\n/** Simulate Deuteranomaly using polynomialized Machado matrix. */\nexport function simulateDeutanPoly(rgb: RGB8, severity: number): RGB8 {\n  const lin: Vec3 = [\n    srgbToLinear(rgb[0]/255),\n    srgbToLinear(rgb[1]/255),\n    srgbToLinear(rgb[2]/255),\n  ];\n  const M = evaluateMatrix(COEFFS, severity);\n  const [R,G,B] = applyMat3(M, lin);\n  return [\n    clamp255(linearToSrgb(clamp01(R))*255),\n    clamp255(linearToSrgb(clamp01(G))*255),\n    clamp255(linearToSrgb(clamp01(B))*255),\n  ];\n}\n\n/**\n * Daltonize for Deuteranomaly via iterative pre-compensation.\n * Finds X such that S(X) ≈ Y (Y=original). Performs T steps:\n *   X_{k+1} = clip( X_k + alpha * ( Y - S(X_k) ) )\n * All operations in linear RGB; final result returned in sRGB 8-bit.\n */\nexport function daltonizeDeutan(rgb: RGB8, severity: number, alpha=0.6, steps=3): RGB8 {\n  // to linear\n  let X: Vec3 = [\n    srgbToLinear(rgb[0]/255),\n    srgbToLinear(rgb[1]/255),\n    srgbToLinear(rgb[2]/255),\n  ];\n  const Y: Vec3 = [...X];\n  const M = evaluateMatrix(COEFFS, severity);\n\n  const simulateLin = (v: Vec3): Vec3 => applyMat3(M, v);\n\n  for (let t = 0; t < steps; t++) {\n    const Sx = simulateLin(X);\n    // residual towards target Y\n    const err: Vec3 = [Y[0]-Sx[0], Y[1]-Sx[1], Y[2]-Sx[2]];\n    X = [\n      clamp01(X[0] + alpha * err[0]),\n      clamp01(X[1] + alpha * err[1]),\n      clamp01(X[2] + alpha * err[2]),\n    ];\n  }\n\n  return [\n    clamp255(linearToSrgb(X[0])*255),\n    clamp255(linearToSrgb(X[1])*255),\n    clamp255(linearToSrgb(X[2])*255),\n  ];\n}\n\n/**\n * Green enhancement \"inverse-ish\" filter in linear space.\n * This is not a true inverse; it boosts green while attenuating red/blue.\n * @param rgb 8-bit sRGB triple [0..255]\n * @param strength α in [0,1], typical 0.1~0.3\n */\nexport function enhanceGreen(rgb: RGB8, strength: number = 0.2): RGB8 {\n  const s = Math.max(0, Math.min(1, strength));\n  const E: Mat3 = [\n    [1 - s, 0,     0    ],\n    [0,     1 + s, 0    ],\n    [0,     0,     1 - s],\n  ];\n  const [r,g,b] = rgb.map(v => srgbToLinear(v/255)) as Vec3;\n  const [R,G,B] = applyMat3(E, [r,g,b]);\n  return [\n    clamp255(linearToSrgb(R)*255),\n    clamp255(linearToSrgb(G)*255),\n    clamp255(linearToSrgb(B)*255),\n  ];\n}\n\n/**\n * デュータン補正フィルター（Daltonization使用）\n * Machado 2009モデルによる科学的補正\n * @param rgb 8-bit sRGB triple [0..255]\n * @param strength 補正強度 α in [0,1], typical 0.1~0.3\n * @returns 補正されたRGB値\n */\nexport function correctForDeutan(rgb: RGB8, strength: number = 0.2): RGB8 {\n  return daltonizeDeutan(rgb, strength, 0.6, 3);\n}\n\n/**\n * RGB値配列に対するバッチ処理版\n * @param rgbArray RGB値の配列\n * @param severity デュータンシミュレーション強度\n * @returns シミュレーション結果の配列\n */\nexport function simulateDeutanBatch(rgbArray: RGB8[], severity: number): RGB8[] {\n  return rgbArray.map(rgb => simulateDeutanPoly(rgb, severity));\n}\n\n/**\n * Canvas ImageDataに対するデュータンシミュレーション\n * @param imageData Canvas ImageData\n * @param severity シミュレーション強度\n * @returns 変換されたImageData\n */\nexport function simulateDeutanImageData(imageData: ImageData, severity: number): ImageData {\n  const data = new Uint8ClampedArray(imageData.data);\n  \n  for (let i = 0; i < data.length; i += 4) {\n    const [r, g, b] = simulateDeutanPoly([data[i], data[i + 1], data[i + 2]], severity);\n    data[i] = r;\n    data[i + 1] = g;\n    data[i + 2] = b;\n    // alpha channel (data[i + 3]) is preserved\n  }\n  \n  return new ImageData(data, imageData.width, imageData.height);\n}\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport type { ColorVisionSettings } from '../types/color';\r\nimport { simulateDeutanPoly, correctForDeutan, type RGB8 } from '../utils/deutan-simulator';\r\n\r\n// HSLからRGBへの変換関数（純粋JavaScript実装）\r\nfunction hslToRgb(h: number, s: number, l: number): [number, number, number] {\r\n  h = h / 360;\r\n  s = s / 100;\r\n  l = l / 100;\r\n\r\n  const hue2rgb = (p: number, q: number, t: number): number => {\r\n    if (t < 0) t += 1;\r\n    if (t > 1) t -= 1;\r\n    if (t < 1/6) return p + (q - p) * 6 * t;\r\n    if (t < 1/2) return q;\r\n    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;\r\n    return p;\r\n  };\r\n\r\n  let r: number, g: number, b: number;\r\n\r\n  if (s === 0) {\r\n    r = g = b = l; // achromatic\r\n  } else {\r\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n    const p = 2 * l - q;\r\n    r = hue2rgb(p, q, h + 1/3);\r\n    g = hue2rgb(p, q, h);\r\n    b = hue2rgb(p, q, h - 1/3);\r\n  }\r\n\r\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\r\n}\r\n\r\ninterface ColorInfo {\r\n  hue: number;\r\n  saturation: number;\r\n  lightness: number;\r\n  rgb: [number, number, number];\r\n  position: { x: number; y: number };\r\n  ring: number;\r\n  originalColor: string;  // HSL色文字列\r\n  finalColor: string;     // 色覚調整後の色文字列\r\n  circleSize: number;     // 円のサイズ\r\n}\r\n\r\ninterface ColorWheelProps {\r\n  colorVisionSettings: ColorVisionSettings;\r\n}\r\n\r\n/**\r\n * 24色相環コンポーネント\r\n * - 6リング × 24色相 = 144色\r\n * - 外側: 鮮やかな原色\r\n * - 内側: 淡いパステルカラー\r\n */\r\nexport const ColorWheel: React.FC<ColorWheelProps> = ({ colorVisionSettings }) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const [selectedColor, setSelectedColor] = useState<ColorInfo | null>(null);\r\n  const [effectEnabled, setEffectEnabled] = useState<boolean>(true);\r\n  const [colorData, setColorData] = useState<ColorInfo[]>([]);\r\n  const [isInitialized, setIsInitialized] = useState<boolean>(false);\r\n  const [ripples, setRipples] = useState<Array<{\r\n    id: number;\r\n    x: number;\r\n    y: number;\r\n    radius: number;\r\n    opacity: number;\r\n    color: string;\r\n    startTime: number;\r\n    maxRadius: number;\r\n  }>>([]);\r\n  const [particles, setParticles] = useState<Array<{\r\n    id: number;\r\n    x: number;\r\n    y: number;\r\n    vx: number;\r\n    vy: number;\r\n    life: number;\r\n    maxLife: number;\r\n    size: number;\r\n    color: string;\r\n  }>>([]);\r\n\r\n  // 色データ事前計算\r\n  const calculateColorData = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return [];\r\n\r\n    // キャンバスサイズ設定\r\n    const size = Math.min(window.innerWidth - 40, 600);\r\n    canvas.width = size;\r\n    canvas.height = size;\r\n    \r\n    const centerX = size / 2;\r\n    const centerY = size / 2;\r\n\r\n    // リング配置（デスクトップサイズ基準で比率計算）\r\n    const baseRadius = size / 2 - 20;\r\n    const ringRadii = [\r\n      baseRadius * 0.94,  // リング1: 最外側\r\n      baseRadius * 0.74,  // リング2\r\n      baseRadius * 0.58,  // リング3\r\n      baseRadius * 0.44,  // リング4\r\n      baseRadius * 0.33,  // リング5\r\n      baseRadius * 0.23,  // リング6: 最内側\r\n    ];\r\n\r\n    // 円のサイズ（比率で調整）\r\n    const circleSizes = [\r\n      baseRadius * 0.082,  // 54px相当\r\n      baseRadius * 0.070,  // 46px相当\r\n      baseRadius * 0.058,  // 38px相当\r\n      baseRadius * 0.046,  // 30px相当\r\n      baseRadius * 0.036,  // 24px相当\r\n      baseRadius * 0.023,  // 15px相当\r\n    ];\r\n\r\n    // 色データを保存する配列\r\n    const newColorData: ColorInfo[] = [];\r\n\r\n    // 6リング計算\r\n    for (let ring = 0; ring < 6; ring++) {\r\n      const radius = ringRadii[ring];\r\n      const circleSize = circleSizes[ring];\r\n      \r\n      // HSL色空間: 外側(暗い鮮やか) → 内側(明るい淡い)\r\n      const lightness = 50 + ring * 7;   // 50, 57, 64, 71, 78, 85\r\n      const saturation = 100 - ring * 14; // 100, 86, 72, 58, 44, 30\r\n\r\n      // 24色相を計算\r\n      for (let i = 0; i < 24; i++) {\r\n        const hue = i * 15; // 0°, 15°, 30°, ..., 345°\r\n        const angle = (hue * Math.PI) / 180;\r\n        \r\n        // 円の位置計算\r\n        const x = centerX + Math.cos(angle) * radius;\r\n        const y = centerY + Math.sin(angle) * radius;\r\n\r\n        // HSLからRGBに変換\r\n        const originalColor = `hsl(${hue}, ${saturation}%, ${lightness}%)`;\r\n        \r\n        // HSL→RGB変換（純粋JavaScript関数を使用）\r\n        let rgb: RGB8 = hslToRgb(hue, saturation, lightness);\r\n        let finalRgb: [number, number, number] = [rgb[0], rgb[1], rgb[2]];\r\n        \r\n        // ================================================================\r\n        // 【重要】色覚シミュレーション・補正の実装について\r\n        // \r\n        // この実装は科学的根拠に基づいた正確な色覚処理を行っています：\r\n        // \r\n        // 1. simulateDeutanPoly(): Machado et al. (2009) の研究に基づく\r\n        //    正確な色覚シミュレーション。多項式補間により高精度な変換を実現。\r\n        //    ※ 簡易的な色変換に置き換えないこと\r\n        // \r\n        // 2. daltonizeDeutan(): 反復的事前補償アルゴリズムによる補正\r\n        //    シミュレーション逆変換を反復計算で近似し、色の区別を最大化。\r\n        //    ※ 単純な色相シフトや彩度調整では同等の効果は得られません\r\n        //\r\n        // 3. 処理の独立性: シミュレーションと補正は独立して動作する必要があります\r\n        //    - シミュレーションOFF + 補正ON: 色覚異常者向けのアクセシビリティ機能\r\n        //    - シミュレーションON + 補正ON: 補正効果のプレビュー機能\r\n        //    ※ この独立性を保つことが重要です\r\n        //\r\n        // 【注意】\r\n        // - correctForDeutan()はdaltonizeDeutan()を呼び出しており、\r\n        //   これは「補正」のための関数です（シミュレーションではありません）\r\n        // - strength/severityパラメータは0-1の範囲で効果の強度を調整します\r\n        // - 安易に「より簡単な」実装に置き換えると、科学的な正確性が失われます\r\n        // ================================================================\r\n        \r\n        // 色覚シミュレーション適用（Machado et al. 2009 準拠）\r\n        // ※ 簡易実装に置き換えないこと - 正確な色覚異常シミュレーションが必要\r\n        if (colorVisionSettings.simulation.useSimulation && \r\n            colorVisionSettings.simulation.simulationType === 'deuteranopia') {\r\n          // シミュレーション適用\r\n          const originalRgb = [...rgb] as RGB8;\r\n          rgb = simulateDeutanPoly(rgb, colorVisionSettings.simulation.severity);\r\n          finalRgb = [rgb[0], rgb[1], rgb[2]]; // 🔥 バグ修正: finalRgbを更新\r\n          \r\n          // デバッグ: シミュレーション効果を確認\r\n          if (ring === 0 && i === 0) { // 最外側の最初の円のみログ出力\r\n            console.log('🎨 Deuteranopia simulation applied:', {\r\n              original: originalRgb,\r\n              simulated: rgb,\r\n              severity: colorVisionSettings.simulation.severity\r\n            });\r\n          }\r\n        }\r\n        \r\n        // 補正フィルター適用（Daltonization アルゴリズム）\r\n        // ※ 単純な色調整では不十分 - 反復的事前補償により最適な補正を実現\r\n        // ※ シミュレーションとは独立 - どちらか一方、または両方を適用可能\r\n        if (colorVisionSettings.correction.useCorrection && \r\n            colorVisionSettings.correction.correctionType === 'deuteranopia') {\r\n          const preCorrection = [...rgb] as RGB8;\r\n          rgb = correctForDeutan(rgb, colorVisionSettings.correction.strength);\r\n          finalRgb = [rgb[0], rgb[1], rgb[2]]; // 🔥 バグ修正: finalRgbを更新\r\n          \r\n          // デバッグ: 補正効果を確認\r\n          if (ring === 0 && i === 0) { // 最外側の最初の円のみログ出力\r\n            console.log('✅ Deuteranopia correction applied:', {\r\n              beforeCorrection: preCorrection,\r\n              afterCorrection: rgb,\r\n              strength: colorVisionSettings.correction.strength\r\n            });\r\n          }\r\n        }\r\n        \r\n        const finalColor = `rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]})`;\r\n\r\n        // 色データを保存\r\n        newColorData.push({\r\n          hue,\r\n          saturation,\r\n          lightness,\r\n          rgb: finalRgb,\r\n          position: { x, y },\r\n          ring: ring + 1,\r\n          originalColor,\r\n          finalColor,\r\n          circleSize\r\n        });\r\n      }\r\n    }\r\n\r\n    // 中央に白い円を追加\r\n    const centerCircleSize = baseRadius * 0.12; // 適切なサイズ\r\n    newColorData.push({\r\n      hue: 0,\r\n      saturation: 0,\r\n      lightness: 100,\r\n      rgb: [255, 255, 255],\r\n      position: { x: centerX, y: centerY },\r\n      ring: 0, // 中央を示す特別な値\r\n      originalColor: 'hsl(0, 0%, 100%)',\r\n      finalColor: '#ffffff', // 白は変換なし\r\n      circleSize: centerCircleSize\r\n    });\r\n\r\n    return newColorData;\r\n  }, [colorVisionSettings]);\r\n\r\n  // hex -> RGB変換（#RRGGBB形式）\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : null;\r\n  };\r\n\r\n\r\n  // RGB -> HSL変換\r\n  const rgbToHsl = (r: number, g: number, b: number) => {\r\n    r /= 255;\r\n    g /= 255;\r\n    b /= 255;\r\n    \r\n    const max = Math.max(r, g, b);\r\n    const min = Math.min(r, g, b);\r\n    let h = 0, s = 0;\r\n    const l = (max + min) / 2;\r\n    \r\n    if (max !== min) {\r\n      const d = max - min;\r\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n      \r\n      switch (max) {\r\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n        case g: h = (b - r) / d + 2; break;\r\n        case b: h = (r - g) / d + 4; break;\r\n      }\r\n      h /= 6;\r\n    }\r\n    \r\n    return { h: h * 360, s: s * 100, l: l * 100 };\r\n  };\r\n\r\n\r\n\r\n  // ダブルライト効果 - 両側からの色付き照明\r\n  const apply3DLighting = useCallback((ctx: CanvasRenderingContext2D, colorInfo: any, circleSize: number, intensity: number) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return null;\r\n\r\n    // RGB文字列パーサー（関数内に移動）\r\n    const rgbStringToRgb = (rgbString: string) => {\r\n      const match = rgbString.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\r\n      return match ? {\r\n        r: parseInt(match[1], 10),\r\n        g: parseInt(match[2], 10),\r\n        b: parseInt(match[3], 10)\r\n      } : null;\r\n    };\r\n\r\n    // 基本色を取得\r\n    const baseRgb = rgbStringToRgb(colorInfo.finalColor);\r\n    if (!baseRgb) {\r\n      console.error('🚨 RGB parsing failed:', colorInfo.finalColor);\r\n      return null;\r\n    }\r\n\r\n    // ダブルライト効果: 直接canvasに描画\r\n    // 左側からピンク/赤の光、右側から青/シアンの光\r\n    \r\n    // 現在の描画状態を保存\r\n    ctx.save();\r\n    \r\n    // 円形クリッピングマスクを作成（円の形を維持）\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x, colorInfo.position.y, circleSize, 0, 2 * Math.PI);\r\n    ctx.clip();\r\n    \r\n    // 線形グラデーション: 左（ピンク/赤）から右（青/シアン）\r\n    const gradient = ctx.createLinearGradient(\r\n      colorInfo.position.x - circleSize, // 左端\r\n      colorInfo.position.y,\r\n      colorInfo.position.x + circleSize, // 右端  \r\n      colorInfo.position.y\r\n    );\r\n    \r\n    // ダブルライト効果の色計算\r\n    const pinkIntensity = intensity * 0.7;\r\n    const blueIntensity = intensity * 0.7;\r\n    \r\n    // 左側のピンク/赤光の色\r\n    const pinkLight = {\r\n      r: Math.min(255, baseRgb.r + (255 - baseRgb.r) * pinkIntensity * 0.8),\r\n      g: Math.min(255, baseRgb.g + (80) * pinkIntensity * 0.4),\r\n      b: Math.min(255, baseRgb.b + (120) * pinkIntensity * 0.4)\r\n    };\r\n    \r\n    // 右側の青/シアン光の色\r\n    const blueLight = {\r\n      r: Math.min(255, baseRgb.r + (80) * blueIntensity * 0.4),\r\n      g: Math.min(255, baseRgb.g + (180) * blueIntensity * 0.6),\r\n      b: Math.min(255, baseRgb.b + (255 - baseRgb.b) * blueIntensity * 0.8)\r\n    };\r\n    \r\n    // グラデーション設定: 左（ピンク）→中央（元の色）→右（青）\r\n    gradient.addColorStop(0, `rgb(${Math.round(pinkLight.r)}, ${Math.round(pinkLight.g)}, ${Math.round(pinkLight.b)})`);\r\n    gradient.addColorStop(0.5, colorInfo.finalColor); // 中央は元の色\r\n    gradient.addColorStop(1, `rgb(${Math.round(blueLight.r)}, ${Math.round(blueLight.g)}, ${Math.round(blueLight.b)})`);\r\n    \r\n    // 円を描画（クリッピングマスク内で）\r\n    ctx.fillStyle = gradient;\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x, colorInfo.position.y, circleSize, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n    \r\n    // オーバーレイブレンドモードで自然な色の混合\r\n    ctx.globalCompositeOperation = 'overlay';\r\n    ctx.globalAlpha = intensity * 0.3; // 軽いオーバーレイ効果\r\n    \r\n    // 再度描画してブレンド効果を適用\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x, colorInfo.position.y, circleSize, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n    \r\n    // 描画状態を復元\r\n    ctx.restore();\r\n    \r\n    // 直接描画したので null を返す（gradientオブジェクトは不要）\r\n    return null;\r\n  }, []);;\r\n\r\n  // 遠近感効果\r\n  const applyDepthEffect = useCallback((colorInfo: any, intensity: number) => {\r\n    if (!selectedColor) return { color: colorInfo.finalColor, size: 1.0 };\r\n\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return { color: colorInfo.finalColor, size: 1.0 };\r\n\r\n    // 選択された円からの距離を計算\r\n    const dist = Math.sqrt(\r\n      Math.pow(colorInfo.position.x - selectedColor.position.x, 2) + \r\n      Math.pow(colorInfo.position.y - selectedColor.position.y, 2)\r\n    );\r\n    \r\n    const maxDist = canvas.width * 0.5;\r\n    const distanceFactor = Math.min(1, dist / maxDist);\r\n    \r\n    // 遠いほど彩度を下げ、明度を上げる（霧がかった効果）\r\n    const rgb = hexToRgb(colorInfo.finalColor);\r\n    if (!rgb) return { color: colorInfo.finalColor, size: 1.0 };\r\n    \r\n    const saturationReduction = distanceFactor * intensity * 0.6;\r\n    const lightnessIncrease = distanceFactor * intensity * 0.3;\r\n    \r\n    // HSLに変換して調整\r\n    const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);\r\n    hsl.s *= (1 - saturationReduction);\r\n    hsl.l = Math.min(100, hsl.l + lightnessIncrease * 100);\r\n    \r\n    const adjustedRgb = hslToRgb(hsl.h, hsl.s, hsl.l);\r\n    const adjustedColor = `rgb(${adjustedRgb[0]}, ${adjustedRgb[1]}, ${adjustedRgb[2]})`;\r\n    \r\n    // サイズも距離に応じて調整（近いものは大きく）\r\n    const sizeMultiplier = 1 + (1 - distanceFactor) * intensity * 0.2;\r\n    \r\n    return { color: adjustedColor, size: sizeMultiplier };\r\n  }, [selectedColor]);\r\n\r\n  // 特殊効果の適用関数\r\n  const applySpecialEffect = useCallback((ctx: CanvasRenderingContext2D, colorInfo: any, circleSize: number) => {\r\n    const { specialEffect } = colorVisionSettings;\r\n    if (!specialEffect.enabled) return { color: colorInfo.finalColor, size: circleSize, gradient: null, skipDrawing: false };\r\n\r\n    let finalColor = colorInfo.finalColor;\r\n    let finalSize = circleSize;\r\n    let gradient = null;\r\n    let skipDrawing = false; // 通常の円描画をスキップするかどうか\r\n\r\n    switch (specialEffect.type) {\r\n      case 'double-light':\r\n        // ダブルライト効果は apply3DLighting で直接描画されるため、通常の描画をスキップ\r\n        apply3DLighting(ctx, colorInfo, circleSize, specialEffect.intensity);\r\n        skipDrawing = true; // 通常の円描画はスキップ\r\n        break;\r\n      \r\n      case 'depth':\r\n        const result = applyDepthEffect(colorInfo, specialEffect.intensity);\r\n        finalColor = result.color;\r\n        finalSize = circleSize * result.size;\r\n        break;\r\n      \r\n      default:\r\n        break;\r\n    }\r\n\r\n    return { color: finalColor, size: finalSize, gradient, skipDrawing };\r\n  }, [colorVisionSettings, apply3DLighting, applyDepthEffect]);;\r\n\r\n  // ムンカー錯視の背景ストライプ\r\n  const drawMunkerBackgroundStripes = (ctx: CanvasRenderingContext2D, size: number, colorVisionSettings: ColorVisionSettings) => {\r\n    const stripeWidth = Math.max(4, Math.floor(size * 0.015));\r\n    const alpha = Math.min(0.4, colorVisionSettings.specialEffect.intensity * 0.4);\r\n    const stripePattern = colorVisionSettings.specialEffect.details.munker?.stripePattern || 'red-green';\r\n    \r\n    // パターンから背景色（最初の色）を決定\r\n    let bgColor;\r\n    switch (stripePattern) {\r\n      case 'red-green': \r\n      case 'red-blue': bgColor = `rgba(255, 60, 60, ${alpha})`; break; // 赤\r\n      case 'green-red':\r\n      case 'green-blue': bgColor = `rgba(60, 255, 60, ${alpha})`; break; // 緑\r\n      case 'blue-red':\r\n      case 'blue-green': bgColor = `rgba(60, 60, 255, ${alpha})`; break; // 青\r\n    }\r\n    \r\n    ctx.save();\r\n    ctx.fillStyle = bgColor;\r\n    \r\n    // 背景ストライプを描画（奇数位置）\r\n    for (let x = 0; x < size; x += stripeWidth * 2) {\r\n      ctx.fillRect(x, 0, stripeWidth, size);\r\n    }\r\n    \r\n    ctx.restore();\r\n  };;\r\n\r\n  const drawMunkerForegroundStripes = (ctx: CanvasRenderingContext2D, size: number, colorVisionSettings: ColorVisionSettings) => {\r\n    const stripeWidth = Math.max(4, Math.floor(size * 0.015));\r\n    const alpha = Math.min(0.4, colorVisionSettings.specialEffect.intensity * 0.4);\r\n    const stripePattern = colorVisionSettings.specialEffect.details.munker?.stripePattern || 'red-green';\r\n    \r\n    // パターンから前景色（2番目の色）を決定\r\n    let fgColor;\r\n    switch (stripePattern) {\r\n      case 'red-green':\r\n      case 'blue-green': fgColor = `rgba(60, 255, 60, ${alpha})`; break; // 緑\r\n      case 'green-red':\r\n      case 'blue-red': fgColor = `rgba(255, 60, 60, ${alpha})`; break; // 赤\r\n      case 'red-blue':\r\n      case 'green-blue': fgColor = `rgba(60, 60, 255, ${alpha})`; break; // 青\r\n    }\r\n    \r\n    ctx.save();\r\n    ctx.fillStyle = fgColor;\r\n    \r\n    // 前景ストライプを描画（偶数位置）\r\n    for (let x = stripeWidth; x < size; x += stripeWidth * 2) {\r\n      ctx.fillRect(x, 0, stripeWidth, size);\r\n    }\r\n    \r\n    ctx.restore();\r\n  };;;;;;\r\n\r\n  // グリッチ効果の描画\r\n  const drawGlitchEffect = (ctx: CanvasRenderingContext2D, colorInfo: any, circleSize: number, intensity: number) => {\r\n    const offset = intensity * 4;\r\n    \r\n    // まず元の円を描画\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x, colorInfo.position.y, circleSize, 0, Math.PI * 2);\r\n    ctx.fillStyle = colorInfo.finalColor;\r\n    ctx.fill();\r\n    \r\n    // 半透明でRGBチャンネルをずらして重ねる\r\n    ctx.globalAlpha = 0.6;\r\n    \r\n    // 赤チャンネルを右にずらす（赤っぽく）\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x + offset, colorInfo.position.y, circleSize, 0, Math.PI * 2);\r\n    ctx.fillStyle = 'rgba(255, 50, 50, 0.4)';\r\n    ctx.fill();\r\n    \r\n    // シアンチャンネルを左にずらす（青緑っぽく）\r\n    ctx.beginPath();\r\n    ctx.arc(colorInfo.position.x - offset, colorInfo.position.y, circleSize, 0, Math.PI * 2);\r\n    ctx.fillStyle = 'rgba(50, 255, 255, 0.4)';\r\n    ctx.fill();\r\n    \r\n    // より細かいノイズ効果\r\n    if (intensity > 0.5) {\r\n      ctx.globalAlpha = 0.3;\r\n      const smallOffset = offset * 0.3;\r\n      \r\n      // 緑チャンネルを上下にずらす\r\n      ctx.beginPath();\r\n      ctx.arc(colorInfo.position.x, colorInfo.position.y - smallOffset, circleSize, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(50, 255, 50, 0.3)';\r\n      ctx.fill();\r\n      \r\n      ctx.beginPath();\r\n      ctx.arc(colorInfo.position.x, colorInfo.position.y + smallOffset, circleSize, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(255, 50, 255, 0.3)';\r\n      ctx.fill();\r\n    }\r\n    \r\n    ctx.globalAlpha = 1.0;\r\n  };\r\n\r\n  // 色相環描画（キャッシュされた色データを使用）\r\n  const drawColorWheel = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || colorData.length === 0) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    const size = canvas.width;\r\n    \r\n    // 背景を白でクリア\r\n    ctx.fillStyle = '#ffffff';\r\n    ctx.fillRect(0, 0, size, size);\r\n\r\n    // ムンカー錯視: 背景ストライプを最初に描画\r\n    if (colorVisionSettings.specialEffect.enabled && colorVisionSettings.specialEffect.type === 'munker') {\r\n      drawMunkerBackgroundStripes(ctx, size, colorVisionSettings);\r\n    }\r\n\r\n    // リング配置（デスクトップサイズ基準で比率計算）\r\n    const baseRadius = size / 2 - 20;\r\n    const circleSizes = [\r\n      baseRadius * 0.082,  // 54px相当\r\n      baseRadius * 0.070,  // 46px相当\r\n      baseRadius * 0.058,  // 38px相当\r\n      baseRadius * 0.046,  // 30px相当\r\n      baseRadius * 0.036,  // 24px相当\r\n      baseRadius * 0.023,  // 15px相当\r\n    ];\r\n\r\n    // 保存された色データを使って描画\r\n    colorData.forEach(colorInfo => {\r\n      // 中央の白い円は描画しない（クリック領域としてのみ存在）\r\n      if (colorInfo.ring === 0) return;\r\n      \r\n      // 通常の円のサイズを決定\r\n      let circleSize = circleSizes[colorInfo.ring - 1];\r\n      \r\n      // 特殊効果を適用\r\n      const effectResult = applySpecialEffect(ctx, colorInfo, circleSize);\r\n      circleSize = effectResult.size;\r\n      \r\n      // skipDrawingフラグがtrueの場合は通常の描画をスキップ（ダブルライト効果は直接描画済み）\r\n      if (effectResult.skipDrawing) {\r\n        return; // 早期リターンで通常描画をスキップ\r\n      }\r\n      \r\n      // ウォーターカラー効果の場合は影を追加\r\n      if (colorVisionSettings.specialEffect.enabled && colorVisionSettings.specialEffect.type === 'watercolor') {\r\n        ctx.shadowColor = effectResult.color;\r\n        ctx.shadowBlur = colorVisionSettings.specialEffect.intensity * 10;\r\n        ctx.shadowOffsetX = 0;\r\n        ctx.shadowOffsetY = 0;\r\n      }\r\n      \r\n      // グリッチ効果の場合はチャンネル分離描画\r\n      if (colorVisionSettings.specialEffect.enabled && colorVisionSettings.specialEffect.type === 'glitch') {\r\n        drawGlitchEffect(ctx, colorInfo, circleSize, colorVisionSettings.specialEffect.intensity);\r\n      } else {\r\n        // 通常の円描画\r\n        ctx.beginPath();\r\n        ctx.arc(colorInfo.position.x, colorInfo.position.y, circleSize, 0, Math.PI * 2);\r\n        \r\n        // 基本的な球体グラデーション、または平面的な単色塗りつぶし\r\n        ctx.fillStyle = effectResult.color;\r\n        ctx.fill();\r\n      }\r\n      \r\n      // 影をリセット\r\n      ctx.shadowBlur = 0;\r\n    });\r\n    \r\n    // ムンカー錯視: 前景ストライプを最後に描画\r\n    if (colorVisionSettings.specialEffect.enabled && colorVisionSettings.specialEffect.type === 'munker') {\r\n      drawMunkerForegroundStripes(ctx, size, colorVisionSettings);\r\n    }\r\n  }, [colorData, effectEnabled, selectedColor, colorVisionSettings, applySpecialEffect]);;;;;\r\n\r\n\r\n  // 初期化とデータ管理\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      const newColorData = calculateColorData();\r\n      setColorData(newColorData);\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized, calculateColorData]);\r\n\r\n  // 色覚設定変更時の再計算\r\n  useEffect(() => {\r\n    if (isInitialized) {\r\n      const newColorData = calculateColorData();\r\n      setColorData(newColorData);\r\n    }\r\n  }, [colorVisionSettings, calculateColorData, isInitialized]);\r\n\r\n  // 描画処理（統合）\r\n  useEffect(() => {\r\n    if (colorData.length > 0) {\r\n      drawColorWheel();\r\n    }\r\n  }, [colorData, drawColorWheel, selectedColor, effectEnabled]);\r\n\r\n  // リップルエフェクトを開始\r\n  const startRippleEffect = useCallback((color: ColorInfo) => {\r\n    const maxRadius = 300; // 固定値（円のサイズに関係なく統一）\r\n    \r\n    const newRipple = {\r\n      id: Date.now() + Math.random(),\r\n      x: color.position.x,\r\n      y: color.position.y,\r\n      radius: 10, // 固定の小さい開始サイズ\r\n      opacity: 1,\r\n      color: `hsl(${color.hue}, ${color.saturation}%, ${color.lightness}%)`,\r\n      startTime: Date.now(),\r\n      maxRadius, // 最大サイズを追加\r\n    };\r\n    \r\n    setRipples(prev => [...prev, newRipple]);\r\n  }, []);\r\n\r\n  // パーティクルエフェクトを開始\r\n  const startParticleEffect = useCallback((color: ColorInfo) => {\r\n    const newParticles: Array<{\r\n      id: number;\r\n      x: number;\r\n      y: number;\r\n      vx: number;\r\n      vy: number;\r\n      life: number;\r\n      maxLife: number;\r\n      size: number;\r\n      color: string;\r\n    }> = [];\r\n    const particleCount = 8;\r\n    \r\n    for (let i = 0; i < particleCount; i++) {\r\n      const angle = (i / particleCount) * Math.PI * 2 + (Math.random() - 0.5) * 0.5; // 少し角度をランダムに\r\n      const speed = 3 + Math.random() * 4; // 初速を2倍に（3-7の範囲）\r\n      \r\n      // パーティクルの色とサイズを決定（白い円の場合は白・大きく、その他は元の色・通常サイズ）\r\n      const particleColor = color.ring === 0 \r\n        ? '#ffffff' // 中央の白い円の場合は白\r\n        : `hsl(${color.hue}, ${Math.min(100, color.saturation + 20)}%, ${Math.min(80, color.lightness + 10)}%)`;\r\n      \r\n      const particleSize = color.ring === 0\r\n        ? 4 + Math.random() * 6 // 中央の白い円は大きく（4-10）\r\n        : 2 + Math.random() * 3; // 通常は小さく（2-5）\r\n      \r\n      newParticles.push({\r\n        id: Date.now() + i,\r\n        x: color.position.x,\r\n        y: color.position.y,\r\n        vx: Math.cos(angle) * speed,\r\n        vy: Math.sin(angle) * speed,\r\n        life: 1,\r\n        maxLife: 200 + Math.random() * 100, // 200-300フレーム（2.5倍長く）\r\n        size: particleSize,\r\n        color: particleColor,\r\n      });\r\n    }\r\n    \r\n    setParticles(prev => [...prev, ...newParticles]);\r\n  }, []);\r\n\r\n  // クリックイベントハンドラ\r\n  const handleCanvasClick = useCallback((event: React.MouseEvent<HTMLCanvasElement>) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n    const clickX = event.clientX - rect.left;\r\n    const clickY = event.clientY - rect.top;\r\n\r\n    // キャンバス内の座標に変換\r\n    const scaleX = canvas.width / rect.width;\r\n    const scaleY = canvas.height / rect.height;\r\n    const canvasX = clickX * scaleX;\r\n    const canvasY = clickY * scaleY;\r\n\r\n    // 最も近い色円を見つける\r\n    let nearestColor: ColorInfo | null = null;\r\n    let minDistance = Infinity;\r\n\r\n    colorData.forEach(color => {\r\n      const distance = Math.sqrt(\r\n        Math.pow(canvasX - color.position.x, 2) + \r\n        Math.pow(canvasY - color.position.y, 2)\r\n      );\r\n      if (distance < minDistance) {\r\n        minDistance = distance;\r\n        nearestColor = color;\r\n      }\r\n    });\r\n\r\n    // 一定距離以内の場合のみ選択\r\n    if (nearestColor && minDistance < 30) {\r\n      // 遠近感効果が有効の場合は常に選択状態を更新\r\n      if (colorVisionSettings.specialEffect.enabled && colorVisionSettings.specialEffect.type === 'depth') {\r\n        setSelectedColor(nearestColor);\r\n        // 遠近感効果の場合はパーティクルエフェクトは無効化\r\n        if (effectEnabled) {\r\n          startRippleEffect(nearestColor);\r\n        }\r\n      } else {\r\n        setSelectedColor(nearestColor);\r\n        // エフェクトが有効の場合はエフェクトを実行\r\n        if (effectEnabled) {\r\n          startRippleEffect(nearestColor);\r\n          startParticleEffect(nearestColor);\r\n        }\r\n      }\r\n    }\r\n  }, [colorData, effectEnabled, startRippleEffect, startParticleEffect, colorVisionSettings]);\r\n\r\n  // エフェクトのアニメーションループ\r\n  const animateEffects = useCallback(() => {\r\n    const currentTime = Date.now();\r\n    \r\n    // イージング関数（ease-out-cubic）\r\n    const easeOutCubic = (t: number) => 1 - Math.pow(1 - t, 3);\r\n    \r\n    // リップルの更新\r\n    setRipples(prev => prev.map(ripple => {\r\n      const elapsed = currentTime - ripple.startTime;\r\n      const progress = elapsed / 30000; // 30.0秒で完了（水の波紋のようにとてもゆっくり）\r\n      \r\n      if (progress >= 1) return null;\r\n      \r\n      const startRadius = ripple.radius; // クリックされた円のサイズから開始\r\n      const endRadius = ripple.maxRadius || 80;\r\n      \r\n      // イージングを適用したサイズ変化\r\n      const easedProgress = easeOutCubic(progress);\r\n      \r\n      return {\r\n        ...ripple,\r\n        radius: startRadius + easedProgress * (endRadius - startRadius),\r\n        opacity: Math.exp(-progress * 3) * ripple.opacity, // 水の波紋のように指数的にフェードアウト\r\n      };\r\n    }).filter((ripple): ripple is NonNullable<typeof ripple> => ripple !== null));\r\n\r\n    // パーティクルの更新\r\n    setParticles(prev => prev.map(particle => {\r\n      const canvas = canvasRef.current;\r\n      if (!canvas) return null;\r\n\r\n      const newX = particle.x + particle.vx;\r\n      const newY = particle.y + particle.vy;\r\n      const newLife = particle.life - 1/particle.maxLife;\r\n      \r\n      // 寿命切れまたは画面外に出た場合は削除\r\n      if (newLife <= 0 || \r\n          newX < -particle.size || newX > canvas.width + particle.size ||\r\n          newY < -particle.size || newY > canvas.height + particle.size) {\r\n        return null;\r\n      }\r\n      \r\n      return {\r\n        ...particle,\r\n        x: newX,\r\n        y: newY,\r\n        life: newLife,\r\n        vx: particle.vx * 0.995, // 減速をより緩やか（0.5%/フレーム）\r\n        vy: particle.vy * 0.995, // 減速をより緩やか（0.5%/フレーム）\r\n      };\r\n    }).filter((particle): particle is NonNullable<typeof particle> => particle !== null));\r\n  }, []);\r\n\r\n  // エフェクト描画（同じCanvas上に重ね描き）\r\n  const drawEffects = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || (ripples.length === 0 && particles.length === 0)) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    // リップル描画\r\n    ripples.forEach(ripple => {\r\n      ctx.beginPath();\r\n      ctx.arc(ripple.x, ripple.y, ripple.radius, 0, Math.PI * 2);\r\n      ctx.strokeStyle = ripple.color;\r\n      \r\n      // 拡大に応じて線を細くする（3px → 1.5px）\r\n      const progress = (Date.now() - ripple.startTime) / 3000;\r\n      const lineWidth = Math.max(1.5, 3 * (1 - progress * 0.5));\r\n      ctx.lineWidth = lineWidth;\r\n      \r\n      ctx.globalAlpha = ripple.opacity;\r\n      ctx.stroke();\r\n    });\r\n\r\n    // パーティクル描画\r\n    particles.forEach(particle => {\r\n      if (particle.life > 0.01) { // 閾値を設けてちらつき防止\r\n        ctx.beginPath();\r\n        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\r\n        ctx.fillStyle = particle.color;\r\n        ctx.globalAlpha = Math.max(0, particle.life); // 負の値を防止\r\n        ctx.fill();\r\n        \r\n        // 光る効果\r\n        ctx.shadowColor = particle.color;\r\n        ctx.shadowBlur = 8;\r\n        ctx.fill();\r\n        ctx.shadowBlur = 0;\r\n      }\r\n    });\r\n\r\n    ctx.globalAlpha = 1;\r\n  }, [ripples, particles]);\r\n\r\n  // RequestAnimationFrame を使った最適化されたアニメーションループ\r\n  const animationFrameRef = useRef<number>();\r\n\r\n  const animationLoop = useCallback(() => {\r\n    if (!effectEnabled || (ripples.length === 0 && particles.length === 0)) {\r\n      return;\r\n    }\r\n\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    // キャンバス全体をクリア\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // 色相環を再描画（キャッシュされたデータを使用）\r\n    drawColorWheel();\r\n\r\n    // エフェクト状態を更新\r\n    animateEffects();\r\n\r\n    // エフェクトを描画\r\n    drawEffects();\r\n\r\n    // 次のフレームをスケジュール\r\n    animationFrameRef.current = requestAnimationFrame(animationLoop);\r\n  }, [effectEnabled, ripples.length, particles.length, drawColorWheel, animateEffects, drawEffects]);\r\n\r\n  // アニメーションループの開始/停止\r\n  useEffect(() => {\r\n    if (effectEnabled && (ripples.length > 0 || particles.length > 0)) {\r\n      animationFrameRef.current = requestAnimationFrame(animationLoop);\r\n    } else {\r\n      if (animationFrameRef.current) {\r\n        cancelAnimationFrame(animationFrameRef.current);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (animationFrameRef.current) {\r\n        cancelAnimationFrame(animationFrameRef.current);\r\n      }\r\n    };\r\n  }, [effectEnabled, ripples.length, particles.length, animationLoop]);\r\n\r\n  return (\r\n    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '1rem' }}>\r\n      {/* 色相環 */}\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        background: '#ffffff',\r\n        borderRadius: '1rem',\r\n        boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\r\n        overflow: 'hidden',\r\n      }}>\r\n        <canvas\r\n          ref={canvasRef}\r\n          onClick={handleCanvasClick}\r\n          style={{\r\n            maxWidth: '100%',\r\n            height: 'auto',\r\n            cursor: 'pointer',\r\n          }}\r\n        />\r\n      </div>\r\n\r\n      {/* エフェクト設定チェックボックス */}\r\n      <div style={{\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '0.5rem',\r\n        background: 'rgba(255, 255, 255, 0.95)',\r\n        padding: '0.75rem 1rem',\r\n        borderRadius: '0.5rem',\r\n        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',\r\n        border: '1px solid rgba(0, 0, 0, 0.1)',\r\n      }}>\r\n        <input\r\n          type=\"checkbox\"\r\n          id=\"effect-toggle\"\r\n          checked={effectEnabled}\r\n          onChange={(e) => setEffectEnabled(e.target.checked)}\r\n          style={{\r\n            width: '18px',\r\n            height: '18px',\r\n            cursor: 'pointer',\r\n          }}\r\n        />\r\n        <label \r\n          htmlFor=\"effect-toggle\"\r\n          style={{\r\n            fontSize: '0.875rem',\r\n            cursor: 'pointer',\r\n            userSelect: 'none',\r\n            color: '#333',\r\n          }}\r\n        >\r\n          ✨ エフェクトを有効にする\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport type { ColorVisionSettings } from '../types/color';\r\nimport { ColorWheel } from './ColorWheel';\r\n\r\ninterface ColorCirclesProps {\r\n  colorVisionSettings: ColorVisionSettings;\r\n  width?: number;\r\n  height?: number;\r\n}\r\n\r\n/**\r\n * 色相環を表示するコンポーネント（旧RGB円から変更）\r\n * 24色相 × 6リング = 144色を美しく配置\r\n */\r\nexport const ColorCircles: React.FC<ColorCirclesProps> = ({\r\n  colorVisionSettings,\r\n}) => {\r\n  return (\r\n    <div style={{\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      padding: '1rem',\r\n    }}>\r\n      <ColorWheel colorVisionSettings={colorVisionSettings} />\r\n      {colorVisionSettings.simulation.showSimulationInfo && (\r\n        <div style={{\r\n          position: 'absolute',\r\n          bottom: '1rem',\r\n          left: '50%',\r\n          transform: 'translateX(-50%)',\r\n          padding: '0.5rem 1rem',\r\n          background: 'rgba(240, 249, 255, 0.95)',\r\n          borderRadius: '0.5rem',\r\n          textAlign: 'center',\r\n          border: '1px solid #bfdbfe',\r\n          backdropFilter: 'blur(4px)',\r\n          boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\r\n        }}>\r\n          <span style={{\r\n            fontSize: '0.875rem',\r\n            color: '#374151',\r\n            fontWeight: '500'\r\n          }}>\r\n            {colorVisionSettings.simulation.useSimulation && (\r\n              <>\r\n                {colorVisionSettings.simulation.simulationType === 'deuteranopia' && 'デュータン'}\r\n                {colorVisionSettings.simulation.simulationType === 'protanopia' && 'プロタン'}\r\n                {colorVisionSettings.simulation.simulationType === 'tritanopia' && 'トリタン'}\r\n                シミュレーション ({(colorVisionSettings.simulation.severity * 100).toFixed(0)}%)\r\n              </>\r\n            )}\r\n            {colorVisionSettings.correction.useCorrection && (\r\n              <>\r\n                {colorVisionSettings.simulation.useSimulation && ' | '}\r\n                補正フィルター ({(colorVisionSettings.correction.strength * 100).toFixed(0)}%)\r\n              </>\r\n            )}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","import type { RGBColor, HSLColor } from '../types/color';\n\n/**\n * RGB値を16進数カラーコードに変換\n */\nexport function rgbToHex(rgb: RGBColor): string {\n  const toHex = (n: number): string => {\n    const hex = Math.round(n).toString(16).padStart(2, '0');\n    return hex;\n  };\n  return `#${toHex(rgb.r)}${toHex(rgb.g)}${toHex(rgb.b)}`;\n}\n\n/**\n * 16進数カラーコードをRGB値に変換\n */\nexport function hexToRgb(hex: string): RGBColor | null {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : null;\n}\n\n/**\n * RGB値をHSL色空間に変換\n */\nexport function rgbToHsl(rgb: RGBColor): HSLColor {\n  const r = rgb.r / 255;\n  const g = rgb.g / 255;\n  const b = rgb.b / 255;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h = 0;\n  let s = 0;\n  const l = (max + min) / 2;\n\n  if (max !== min) {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n        break;\n      case g:\n        h = ((b - r) / d + 2) / 6;\n        break;\n      case b:\n        h = ((r - g) / d + 4) / 6;\n        break;\n    }\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    l: Math.round(l * 100),\n  };\n}\n\n/**\n * HSL色空間をRGB値に変換\n */\nexport function hslToRgb(hsl: HSLColor): RGBColor {\n  const h = hsl.h / 360;\n  const s = hsl.s / 100;\n  const l = hsl.l / 100;\n\n  let r: number, g: number, b: number;\n\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255),\n  };\n}\n\n/**\n * 値を指定範囲内にクランプ\n */\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\n/**\n * ガンマ補正を適用\n */\nexport function applyGammaCorrection(value: number, gamma = 2.2): number {\n  return Math.pow(value / 255, gamma) * 255;\n}\n\n/**\n * 逆ガンマ補正を適用\n */\nexport function applyInverseGammaCorrection(value: number, gamma = 2.2): number {\n  return Math.pow(value / 255, 1 / gamma) * 255;\n}","import React, { useCallback } from 'react';\r\nimport type { ColorVisionSettings, ColorVisionType, SpecialEffectType } from '../types/color';\r\nimport { clamp } from '../utils/color-converter';\r\n\r\ninterface ColorAdjusterProps {\r\n  colorVisionSettings: ColorVisionSettings;\r\n  onColorVisionSettingsChange: (settings: ColorVisionSettings) => void;\r\n}\r\n\r\n/**\r\n * 色覚シミュレーション・補正設定コンポーネント\r\n */\r\nexport const ColorAdjuster: React.FC<ColorAdjusterProps> = ({\r\n  colorVisionSettings,\r\n  onColorVisionSettingsChange,\r\n}) => {\r\n\r\n  // シミュレーション設定の変更\r\n  const handleSimulationToggle = useCallback(() => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      simulation: {\r\n        ...colorVisionSettings.simulation,\r\n        useSimulation: !colorVisionSettings.simulation.useSimulation,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleSimulationTypeChange = useCallback((type: ColorVisionType) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      simulation: {\r\n        ...colorVisionSettings.simulation,\r\n        simulationType: type,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleSimulationSeverityChange = useCallback((severity: number) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      simulation: {\r\n        ...colorVisionSettings.simulation,\r\n        severity: clamp(severity, 0, 1),\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  // 補正設定の変更\r\n  const handleCorrectionToggle = useCallback(() => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      correction: {\r\n        ...colorVisionSettings.correction,\r\n        useCorrection: !colorVisionSettings.correction.useCorrection,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleCorrectionTypeChange = useCallback((type: ColorVisionType) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      correction: {\r\n        ...colorVisionSettings.correction,\r\n        correctionType: type,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleCorrectionStrengthChange = useCallback((strength: number) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      correction: {\r\n        ...colorVisionSettings.correction,\r\n        strength: clamp(strength, 0, 1),\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  // 特殊効果設定の変更\r\n  const handleSpecialEffectToggle = useCallback(() => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      specialEffect: {\r\n        ...colorVisionSettings.specialEffect,\r\n        enabled: !colorVisionSettings.specialEffect.enabled,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleSpecialEffectTypeChange = useCallback((type: SpecialEffectType) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      specialEffect: {\r\n        ...colorVisionSettings.specialEffect,\r\n        type,\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n  const handleSpecialEffectIntensityChange = useCallback((intensity: number) => {\r\n    onColorVisionSettingsChange({\r\n      ...colorVisionSettings,\r\n      specialEffect: {\r\n        ...colorVisionSettings.specialEffect,\r\n        intensity: clamp(intensity, 0, 1),\r\n      },\r\n    });\r\n  }, [colorVisionSettings, onColorVisionSettingsChange]);\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      background: '#FFFFFF',\r\n      borderRadius: '0.75rem',\r\n      padding: '2rem',\r\n      boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\r\n      maxWidth: '500px',\r\n      width: '100%'\r\n    }}>\r\n\r\n      {/* 色覚シミュレーション設定 */}\r\n      <div style={{\r\n        marginBottom: '1.5rem',\r\n        padding: '1rem',\r\n        background: '#f8fafc',\r\n        borderRadius: '0.5rem',\r\n        border: '1px solid #e2e8f0'\r\n      }}>\r\n        <h3 style={{\r\n          fontSize: '1rem',\r\n          margin: '0 0 1rem 0',\r\n          color: '#374151'\r\n        }}>色覚シミュレーション</h3>\r\n        \r\n        <div style={{ marginBottom: '1rem' }}>\r\n          <label style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            cursor: 'pointer'\r\n          }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={colorVisionSettings.simulation.useSimulation}\r\n              onChange={handleSimulationToggle}\r\n              style={{ accentColor: '#3B82F6' }}\r\n            />\r\n            <span style={{ fontSize: '0.875rem', fontWeight: '500' }}>\r\n              色覚シミュレーションを有効にする\r\n            </span>\r\n          </label>\r\n        </div>\r\n\r\n        {colorVisionSettings.simulation.useSimulation && (\r\n          <>\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                シミュレーションタイプ:\r\n              </label>\r\n              <select\r\n                value={colorVisionSettings.simulation.simulationType}\r\n                onChange={(e) => handleSimulationTypeChange(e.target.value as ColorVisionType)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #D1D5DB',\r\n                  borderRadius: '0.375rem',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              >\r\n                <option value=\"deuteranopia\">デュータン（緑色覚異常）</option>\r\n                <option value=\"protanopia\">プロタン（赤色覚異常）</option>\r\n                <option value=\"tritanopia\">トリタン（青色覚異常）</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                シミュレーション強度: {(colorVisionSettings.simulation.severity * 100).toFixed(0)}%\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"1\"\r\n                step=\"0.1\"\r\n                value={colorVisionSettings.simulation.severity}\r\n                onChange={(e) => handleSimulationSeverityChange(Number(e.target.value))}\r\n                style={{\r\n                  width: '100%',\r\n                  height: '6px'\r\n                }}\r\n              />\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* 色覚補正設定 */}\r\n      <div style={{\r\n        marginBottom: '1.5rem',\r\n        padding: '1rem',\r\n        background: '#fff7ed',\r\n        borderRadius: '0.5rem',\r\n        border: '1px solid #fed7aa'\r\n      }}>\r\n        <h3 style={{\r\n          fontSize: '1rem',\r\n          margin: '0 0 1rem 0',\r\n          color: '#374151'\r\n        }}>色覚補正フィルター</h3>\r\n        \r\n        <div style={{ marginBottom: '1rem' }}>\r\n          <label style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            cursor: 'pointer'\r\n          }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={colorVisionSettings.correction.useCorrection}\r\n              onChange={handleCorrectionToggle}\r\n              style={{ accentColor: '#ea580c' }}\r\n            />\r\n            <span style={{ fontSize: '0.875rem', fontWeight: '500' }}>\r\n              色覚補正を有効にする\r\n            </span>\r\n          </label>\r\n        </div>\r\n\r\n        {colorVisionSettings.correction.useCorrection && (\r\n          <>\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                補正対象:\r\n              </label>\r\n              <select\r\n                value={colorVisionSettings.correction.correctionType}\r\n                onChange={(e) => handleCorrectionTypeChange(e.target.value as ColorVisionType)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #D1D5DB',\r\n                  borderRadius: '0.375rem',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              >\r\n                <option value=\"deuteranopia\">デュータン（緑色覚異常）</option>\r\n                <option value=\"protanopia\">プロタン（赤色覚異常）</option>\r\n                <option value=\"tritanopia\">トリタン（青色覚異常）</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                補正強度: {(colorVisionSettings.correction.strength * 100).toFixed(0)}%\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"1\"\r\n                step=\"0.1\"\r\n                value={colorVisionSettings.correction.strength}\r\n                onChange={(e) => handleCorrectionStrengthChange(Number(e.target.value))}\r\n                style={{\r\n                  width: '100%',\r\n                  height: '6px'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1rem' }}>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* 特殊視覚効果設定 */}\r\n      <div style={{\r\n        marginBottom: '1.5rem',\r\n        padding: '1rem',\r\n        background: '#f3f4ff',\r\n        borderRadius: '0.5rem',\r\n        border: '1px solid #c7d2fe'\r\n      }}>\r\n        <h3 style={{\r\n          fontSize: '1rem',\r\n          margin: '0 0 1rem 0',\r\n          color: '#374151'\r\n        }}>特殊視覚効果</h3>\r\n        \r\n        <div style={{ marginBottom: '1rem' }}>\r\n          <label style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            cursor: 'pointer'\r\n          }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={colorVisionSettings.specialEffect.enabled}\r\n              onChange={handleSpecialEffectToggle}\r\n              style={{ accentColor: '#7c3aed' }}\r\n            />\r\n            <span style={{ fontSize: '0.875rem', fontWeight: '500' }}>\r\n              特殊視覚効果を有効にする\r\n            </span>\r\n          </label>\r\n        </div>\r\n\r\n        {colorVisionSettings.specialEffect.enabled && (\r\n          <>\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                効果タイプ:\r\n              </label>\r\n              <select\r\n                value={colorVisionSettings.specialEffect.type}\r\n                onChange={(e) => handleSpecialEffectTypeChange(e.target.value as SpecialEffectType)}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #D1D5DB',\r\n                  borderRadius: '0.375rem',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              >\r\n                <option value=\"double-light\">💡 ダブルライト効果</option>\r\n                <option value=\"glitch\">🔸 グリッチ効果</option>\r\n                <option value=\"depth\">🎯 遠近感効果</option>\r\n                <option value=\"watercolor\">🎨 ウォーターカラー効果</option>\r\n                <option value=\"munker\">📐 ムンカー錯視</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1rem' }}>\r\n              <label style={{\r\n                display: 'block',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '500',\r\n                marginBottom: '0.5rem'\r\n              }}>\r\n                効果強度: {(colorVisionSettings.specialEffect.intensity * 100).toFixed(0)}%\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"1\"\r\n                step=\"0.1\"\r\n                value={colorVisionSettings.specialEffect.intensity}\r\n                onChange={(e) => handleSpecialEffectIntensityChange(Number(e.target.value))}\r\n                style={{\r\n                  width: '100%',\r\n                  height: '6px'\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            {/* ムンカー錯視専用の色パターン選択 */}\r\n            {colorVisionSettings.specialEffect.type === 'munker' && (\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <label style={{\r\n                  display: 'block',\r\n                  fontSize: '0.875rem',\r\n                  fontWeight: '500',\r\n                  marginBottom: '0.5rem'\r\n                }}>\r\n                  ストライプ色パターン:\r\n                </label>\r\n                <select\r\n                  value={colorVisionSettings.specialEffect.details.munker?.stripePattern || 'red-green'}\r\n                  onChange={(e) => {\r\n                    const newPattern = e.target.value as 'red-green' | 'green-red' | 'red-blue' | 'blue-red' | 'green-blue' | 'blue-green';\r\n                    onColorVisionSettingsChange({\r\n                      ...colorVisionSettings,\r\n                      specialEffect: {\r\n                        ...colorVisionSettings.specialEffect,\r\n                        details: {\r\n                          ...colorVisionSettings.specialEffect.details,\r\n                          munker: {\r\n                            stripeWidth: colorVisionSettings.specialEffect.details.munker?.stripeWidth || 8,\r\n                            stripePattern: newPattern\r\n                          }\r\n                        }\r\n                      }\r\n                    });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #D1D5DB',\r\n                    borderRadius: '0.375rem',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                >\r\n                  <option value=\"red-green\">🔴Bottom 🟢Top</option>\r\n                  <option value=\"green-red\">🟢Bottom 🔴Top</option>\r\n                  <option value=\"red-blue\">🔴Bottom 🔵Top</option>\r\n                  <option value=\"blue-red\">🔵Bottom 🔴Top</option>\r\n                  <option value=\"green-blue\">🟢Bottom 🔵Top</option>\r\n                  <option value=\"blue-green\">🔵Bottom 🟢Top</option>\r\n                </select>\r\n              </div>\r\n            )}\r\n\r\n            {/* 効果の説明テキスト */}\r\n            <div style={{\r\n              fontSize: '0.75rem',\r\n              color: '#6b7280',\r\n              background: 'rgba(255,255,255,0.5)',\r\n              padding: '0.5rem',\r\n              borderRadius: '0.25rem',\r\n              marginTop: '0.5rem'\r\n            }}>\r\n              {colorVisionSettings.specialEffect.type === 'double-light' && \r\n                '2つの光源から照らされているような効果を追加します'}\r\n              {colorVisionSettings.specialEffect.type === 'glitch' && \r\n                '映像のバグのような色ズレやノイズを意図的に加えます'}\r\n              {colorVisionSettings.specialEffect.type === 'depth' && \r\n                '遠近感を色で表現し、選択した円を近くに見せます'}\r\n              {colorVisionSettings.specialEffect.type === 'watercolor' && \r\n                '境界線の色が内側ににじんで見えるような効果を追加します'}\r\n              {colorVisionSettings.specialEffect.type === 'munker' && \r\n                '背景のストライプパターンにより色が違って見える錯視効果'}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};","import { simulateDeutanPoly, correctForDeutan, type RGB8 } from './deutan-simulator';\nimport type { ColorVisionSettings } from '../types/color';\n\n/**\n * 画像に色変換を適用\n * @param imageData Canvas ImageData\n * @param colorVisionSettings 色覚設定\n * @param onProgress 進捗コールバック\n * @returns 変換されたImageData\n */\nexport async function processImageData(\n  imageData: ImageData,\n  colorVisionSettings: ColorVisionSettings,\n  onProgress?: (progress: number) => void\n): Promise<ImageData> {\n  console.log('processImageData called with settings:', colorVisionSettings);\n  console.log('Image data size:', imageData.width, 'x', imageData.height);\n  \n  const data = new Uint8ClampedArray(imageData.data);\n  const totalPixels = data.length / 4;\n  const batchSize = Math.max(1000, Math.floor(totalPixels / 100)); // バッチサイズ調整\n  \n  let processedPixels = 0;\n  let actuallyProcessed = false;\n\n  // バッチ処理でメインスレッドをブロックしないように\n  for (let i = 0; i < data.length; i += batchSize * 4) {\n    const endIndex = Math.min(i + batchSize * 4, data.length);\n    \n    // バッチ内のピクセルを処理\n    for (let j = i; j < endIndex; j += 4) {\n      const originalRgb: RGB8 = [data[j], data[j + 1], data[j + 2]];\n      let transformedRgb = originalRgb;\n      \n      // シミュレーションを適用\n      if (colorVisionSettings.simulation.useSimulation && \n          colorVisionSettings.simulation.simulationType === 'deuteranopia') {\n        transformedRgb = simulateDeutanPoly(\n          transformedRgb, \n          colorVisionSettings.simulation.severity\n        );\n        actuallyProcessed = true;\n      }\n      \n      // 補正を適用\n      if (colorVisionSettings.correction.useCorrection && \n          colorVisionSettings.correction.correctionType === 'deuteranopia') {\n        transformedRgb = correctForDeutan(\n          transformedRgb, \n          colorVisionSettings.correction.strength\n        );\n        actuallyProcessed = true;\n      }\n      \n      // 結果を書き戻し\n      data[j] = transformedRgb[0];\n      data[j + 1] = transformedRgb[1];\n      data[j + 2] = transformedRgb[2];\n      // alpha channel (data[j + 3]) はそのまま\n      \n      processedPixels++;\n    }\n    \n    // 進捗を報告\n    if (onProgress) {\n      const progress = Math.round((processedPixels / totalPixels) * 100);\n      onProgress(progress);\n    }\n    \n    // メインスレッドに制御を戻す\n    await new Promise(resolve => setTimeout(resolve, 0));\n  }\n  \n  console.log('Processing completed. Actually processed:', actuallyProcessed);\n  console.log('Total pixels processed:', processedPixels);\n  \n  return new ImageData(data, imageData.width, imageData.height);\n}\n\n/**\n * 画像ファイルをCanvasに読み込み\n * @param file 画像ファイル\n * @param maxWidth 最大幅（リサイズ用）\n * @param maxHeight 最大高さ（リサイズ用）\n * @returns Canvas要素とImageData\n */\nexport function loadImageToCanvas(\n  file: File, \n  maxWidth = 4096, \n  maxHeight = 4096\n): Promise<{canvas: HTMLCanvasElement, imageData: ImageData}> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    \n    if (!ctx) {\n      reject(new Error('Canvas context not available'));\n      return;\n    }\n    \n    img.onload = () => {\n      // リサイズ計算\n      let { width, height } = img;\n      if (width > maxWidth || height > maxHeight) {\n        const ratio = Math.min(maxWidth / width, maxHeight / height);\n        width *= ratio;\n        height *= ratio;\n      }\n      \n      canvas.width = width;\n      canvas.height = height;\n      \n      // 画像を描画\n      ctx.drawImage(img, 0, 0, width, height);\n      \n      // ImageDataを取得\n      const imageData = ctx.getImageData(0, 0, width, height);\n      \n      resolve({ canvas, imageData });\n    };\n    \n    img.onerror = () => {\n      reject(new Error('Failed to load image'));\n    };\n    \n    img.src = URL.createObjectURL(file);\n  });\n}\n\n/**\n * ImageDataをCanvasに描画\n * @param canvas Canvas要素\n * @param imageData ImageData\n */\nexport function drawImageDataToCanvas(\n  canvas: HTMLCanvasElement, \n  imageData: ImageData\n): void {\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw new Error('Canvas context not available');\n  \n  canvas.width = imageData.width;\n  canvas.height = imageData.height;\n  ctx.putImageData(imageData, 0, 0);\n}\n\n/**\n * CanvasをBlob/File形式でダウンロード\n * @param canvas Canvas要素\n * @param filename ファイル名\n * @param format 画像フォーマット\n * @param quality 品質（JPEG用）\n */\nexport function downloadCanvasAsImage(\n  canvas: HTMLCanvasElement,\n  filename = 'colorwise-processed.png',\n  format: 'image/png' | 'image/jpeg' | 'image/webp' = 'image/png',\n  quality = 0.9\n): void {\n  canvas.toBlob((blob) => {\n    if (!blob) return;\n    \n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }, format, quality);\n}\n\n/**\n * ファイルサイズを人間に読みやすい形式に変換\n * @param bytes バイト数\n * @returns フォーマットされた文字列\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\n/**\n * 画像ファイルの妥当性をチェック\n * @param file ファイル\n * @param maxSize 最大サイズ（バイト）\n * @returns エラーメッセージまたはnull\n */\nexport function validateImageFile(\n  file: File, \n  maxSize = 10 * 1024 * 1024 // 10MB\n): string | null {\n  // ファイルタイプチェック\n  if (!file.type.startsWith('image/')) {\n    return '画像ファイルを選択してください';\n  }\n  \n  // サポートされている形式チェック\n  const supportedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];\n  if (!supportedTypes.includes(file.type)) {\n    return 'サポートされていない画像形式です（JPEG, PNG, WebP, GIFのみ）';\n  }\n  \n  // ファイルサイズチェック\n  if (file.size > maxSize) {\n    return `ファイルサイズが大きすぎます（最大: ${formatFileSize(maxSize)}）`;\n  }\n  \n  return null;\n}","import React, { useCallback, useState } from 'react';\nimport type { ImageFileInfo, ImageProcessingState } from '../types/color';\nimport { validateImageFile } from '../utils/image-processor';\n\ninterface ImageUploaderProps {\n  onImageLoad: (imageInfo: ImageFileInfo) => void;\n  processingState: ImageProcessingState;\n  disabled?: boolean;\n}\n\n/**\n * 画像アップロードコンポーネント\n */\nexport const ImageUploader: React.FC<ImageUploaderProps> = ({\n  onImageLoad,\n  processingState,\n  disabled = false\n}) => {\n  const [dragOver, setDragOver] = useState(false);\n\n  const handleFileSelect = useCallback((file: File) => {\n    const validationError = validateImageFile(file);\n    if (validationError) {\n      alert(validationError);\n      return;\n    }\n\n    // 画像の寸法を取得\n    const img = new Image();\n    img.onload = () => {\n      const imageInfo: ImageFileInfo = {\n        file,\n        url: URL.createObjectURL(file),\n        width: img.width,\n        height: img.height,\n        size: file.size\n      };\n      onImageLoad(imageInfo);\n    };\n    img.src = URL.createObjectURL(file);\n  }, [onImageLoad]);\n\n  const handleFileInput = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  }, [handleFileSelect]);\n\n  const handleDrop = useCallback((event: React.DragEvent) => {\n    event.preventDefault();\n    setDragOver(false);\n    \n    const file = event.dataTransfer.files[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  }, [handleFileSelect]);\n\n  const handleDragOver = useCallback((event: React.DragEvent) => {\n    event.preventDefault();\n    setDragOver(true);\n  }, []);\n\n  const handleDragLeave = useCallback((event: React.DragEvent) => {\n    event.preventDefault();\n    setDragOver(false);\n  }, []);\n\n  return (\n    <div style={{\n      background: '#FFFFFF',\n      borderRadius: '0.75rem',\n      padding: '2rem',\n      boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\n      width: '100%'\n    }}>\n      <h3 style={{\n        fontSize: '1.25rem',\n        fontWeight: '600',\n        color: '#111827',\n        margin: '0 0 1.5rem 0'\n      }}>\n        📸 写真をアップロード\n      </h3>\n\n      <div\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        style={{\n          border: dragOver \n            ? '2px dashed #3B82F6' \n            : '2px dashed #D1D5DB',\n          borderRadius: '0.5rem',\n          padding: '3rem 1rem',\n          textAlign: 'center',\n          transition: 'all 0.2s ease',\n          background: dragOver ? '#F0F9FF' : '#F9FAFB',\n          cursor: disabled ? 'not-allowed' : 'pointer',\n          opacity: disabled ? 0.5 : 1\n        }}\n      >\n        {processingState.isProcessing ? (\n          <div>\n            <div style={{\n              width: '48px',\n              height: '48px',\n              border: '4px solid #E5E7EB',\n              borderTop: '4px solid #3B82F6',\n              borderRadius: '50%',\n              animation: 'spin 1s linear infinite',\n              margin: '0 auto 1rem'\n            }} />\n            <p style={{\n              color: '#6B7280',\n              fontSize: '1rem',\n              margin: '0 0 0.5rem 0'\n            }}>\n              処理中... {processingState.progress}%\n            </p>\n            <div style={{\n              width: '100%',\n              height: '8px',\n              background: '#E5E7EB',\n              borderRadius: '4px',\n              overflow: 'hidden',\n              margin: '0 auto',\n              maxWidth: '200px'\n            }}>\n              <div style={{\n                width: `${processingState.progress}%`,\n                height: '100%',\n                background: '#3B82F6',\n                transition: 'width 0.3s ease'\n              }} />\n            </div>\n          </div>\n        ) : (\n          <div>\n            <div style={{\n              fontSize: '3rem',\n              marginBottom: '1rem'\n            }}>\n              📷\n            </div>\n            <p style={{\n              color: '#374151',\n              fontSize: '1.125rem',\n              fontWeight: '500',\n              margin: '0 0 0.5rem 0'\n            }}>\n              写真をドラッグ&ドロップ\n            </p>\n            <p style={{\n              color: '#6B7280',\n              fontSize: '0.875rem',\n              margin: '0 0 1.5rem 0'\n            }}>\n              または下のボタンから選択\n            </p>\n            \n            <label style={{\n              display: 'inline-block',\n              background: '#3B82F6',\n              color: 'white',\n              padding: '0.75rem 2rem',\n              borderRadius: '0.5rem',\n              fontWeight: '500',\n              cursor: disabled ? 'not-allowed' : 'pointer',\n              transition: 'background-color 0.2s ease'\n            }}>\n              ファイルを選択\n              <input\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={handleFileInput}\n                disabled={disabled}\n                style={{ display: 'none' }}\n              />\n            </label>\n          </div>\n        )}\n      </div>\n\n      <div style={{\n        marginTop: '1rem',\n        padding: '1rem',\n        background: '#F0F9FF',\n        borderRadius: '0.5rem',\n        border: '1px solid #BFDBFE'\n      }}>\n        <p style={{\n          fontSize: '0.875rem',\n          color: '#374151',\n          margin: '0',\n          lineHeight: '1.5'\n        }}>\n          💡 <strong>対応形式:</strong> JPEG, PNG, WebP, GIF<br />\n          📏 <strong>推奨サイズ:</strong> 10MB以下、1920×1080px以下\n        </p>\n      </div>\n\n      {processingState.error && (\n        <div style={{\n          marginTop: '1rem',\n          padding: '1rem',\n          background: '#FEF2F2',\n          borderRadius: '0.5rem',\n          border: '1px solid #FECACA'\n        }}>\n          <p style={{\n            fontSize: '0.875rem',\n            color: '#DC2626',\n            margin: '0',\n            fontWeight: '500'\n          }}>\n            ❌ エラー: {processingState.error}\n          </p>\n        </div>\n      )}\n\n      <style>\n        {`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `}\n      </style>\n    </div>\n  );\n};","import React, { useRef, useEffect, useState } from 'react';\nimport type { ImageFileInfo, ColorVisionSettings } from '../types/color';\nimport { \n  loadImageToCanvas, \n  processImageData, \n  drawImageDataToCanvas, \n  downloadCanvasAsImage,\n  formatFileSize \n} from '../utils/image-processor';\n\ninterface ImageViewerProps {\n  imageInfo: ImageFileInfo | null;\n  colorVisionSettings: ColorVisionSettings;\n  onProcessingStateChange: (isProcessing: boolean, progress: number, error?: string) => void;\n}\n\ntype ViewMode = 'original' | 'processed' | 'split';\n\n/**\n * 画像表示・処理コンポーネント\n */\nexport const ImageViewer: React.FC<ImageViewerProps> = ({\n  imageInfo,\n  colorVisionSettings,\n  onProcessingStateChange\n}) => {\n  const originalCanvasRef = useRef<HTMLCanvasElement>(null);\n  const processedCanvasRef = useRef<HTMLCanvasElement>(null);\n  const [viewMode, setViewMode] = useState<ViewMode>('processed');\n  const [originalImageData, setOriginalImageData] = useState<ImageData | null>(null);\n  const [processedImageData, setProcessedImageData] = useState<ImageData | null>(null);\n\n  // 画像読み込み\n  useEffect(() => {\n    if (!imageInfo) {\n      setOriginalImageData(null);\n      setProcessedImageData(null);\n      return;\n    }\n\n    const loadImage = async () => {\n      try {\n        onProcessingStateChange(true, 0);\n        \n        const { imageData } = await loadImageToCanvas(imageInfo.file);\n        setOriginalImageData(imageData);\n        \n        // オリジナル画像をcanvasに描画\n        if (originalCanvasRef.current) {\n          drawImageDataToCanvas(originalCanvasRef.current, imageData);\n        }\n        \n        // 画像読み込み完了時は processing状態を継続（色覚処理待ち）\n        console.log('Image loaded, waiting for color processing...');\n      } catch (error) {\n        console.error('画像読み込みエラー:', error);\n        onProcessingStateChange(false, 0, '画像の読み込みに失敗しました');\n      }\n    };\n\n    loadImage();\n  }, [imageInfo]); // onProcessingStateChangeを依存配列から削除\n\n  // 色覚設定変更時の再処理\n  useEffect(() => {\n    if (!originalImageData) return;\n\n    // 処理を遅延させて連続実行を防ぐ\n    const timeoutId = setTimeout(() => {\n      const processImage = async () => {\n        try {\n          console.log('Starting color processing...', colorVisionSettings);\n          onProcessingStateChange(true, 0);\n          \n          const processed = await processImageData(\n            originalImageData, \n            colorVisionSettings,\n            (progress) => {\n              console.log('Processing progress:', progress);\n              onProcessingStateChange(true, progress);\n            }\n          );\n          \n          console.log('Color processing completed');\n          setProcessedImageData(processed);\n          \n          // 処理済み画像をcanvasに描画\n          if (processedCanvasRef.current) {\n            drawImageDataToCanvas(processedCanvasRef.current, processed);\n          }\n          \n          onProcessingStateChange(false, 100);\n        } catch (error) {\n          console.error('画像処理エラー:', error);\n          onProcessingStateChange(false, 0, '画像処理に失敗しました');\n        }\n      };\n\n      processImage();\n    }, 100); // 100ms遅延\n\n    return () => clearTimeout(timeoutId);\n  }, [originalImageData, colorVisionSettings]); // onProcessingStateChangeを依存配列から削除\n\n  const handleDownload = () => {\n    if (!processedCanvasRef.current || !processedImageData) return;\n    \n    const filename = `colorwise-${imageInfo?.file.name || 'processed'}.png`;\n    downloadCanvasAsImage(processedCanvasRef.current, filename);\n  };\n\n  if (!imageInfo) {\n    return (\n      <div style={{\n        background: '#F9FAFB',\n        borderRadius: '0.75rem',\n        padding: '3rem',\n        textAlign: 'center',\n        border: '2px dashed #D1D5DB'\n      }}>\n        <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>🖼️</div>\n        <p style={{\n          color: '#6B7280',\n          fontSize: '1.125rem',\n          margin: '0'\n        }}>\n          画像を選択してください\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{\n      background: '#FFFFFF',\n      borderRadius: '0.75rem',\n      padding: '1.5rem',\n      boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\n      width: '100%'\n    }}>\n      <div style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '1.5rem',\n        flexWrap: 'wrap',\n        gap: '1rem'\n      }}>\n        <div>\n          <h3 style={{\n            fontSize: '1.25rem',\n            fontWeight: '600',\n            color: '#111827',\n            margin: '0 0 0.5rem 0'\n          }}>\n            🖼️ 画像プレビュー\n          </h3>\n          <p style={{\n            fontSize: '0.875rem',\n            color: '#6B7280',\n            margin: '0'\n          }}>\n            {imageInfo.file.name} ({imageInfo.width}×{imageInfo.height}, {formatFileSize(imageInfo.size)})\n          </p>\n        </div>\n        \n        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n          <select\n            value={viewMode}\n            onChange={(e) => setViewMode(e.target.value as ViewMode)}\n            style={{\n              padding: '0.5rem',\n              border: '1px solid #D1D5DB',\n              borderRadius: '0.375rem',\n              fontSize: '0.875rem'\n            }}\n          >\n            <option value=\"original\">元画像</option>\n            <option value=\"processed\">変換済み</option>\n            <option value=\"split\">分割表示</option>\n          </select>\n          \n          <button\n            onClick={handleDownload}\n            disabled={!processedImageData}\n            style={{\n              background: processedImageData ? '#10B981' : '#D1D5DB',\n              color: 'white',\n              padding: '0.5rem 1rem',\n              borderRadius: '0.375rem',\n              fontWeight: '500',\n              border: 'none',\n              cursor: processedImageData ? 'pointer' : 'not-allowed',\n              fontSize: '0.875rem'\n            }}\n          >\n            💾 ダウンロード\n          </button>\n        </div>\n      </div>\n\n      <div style={{\n        borderRadius: '0.5rem',\n        overflow: 'auto',\n        background: '#F3F4F6',\n        position: 'relative',\n        maxHeight: '80vh'\n      }}>\n        {viewMode === 'split' && (\n          <div style={{ display: 'flex', gap: '4px', justifyContent: 'center' }}>\n            <div style={{ position: 'relative' }}>\n              <canvas\n                ref={originalCanvasRef}\n                style={{\n                  maxWidth: '100%',\n                  height: 'auto',\n                  display: 'block'\n                }}\n              />\n              <div style={{\n                position: 'absolute',\n                top: '0.5rem',\n                left: '0.5rem',\n                background: 'rgba(0,0,0,0.7)',\n                color: 'white',\n                padding: '0.25rem 0.5rem',\n                borderRadius: '0.25rem',\n                fontSize: '0.75rem',\n                fontWeight: '500'\n              }}>\n                元画像\n              </div>\n            </div>\n            <div style={{ position: 'relative' }}>\n              <canvas\n                ref={processedCanvasRef}\n                style={{\n                  maxWidth: '100%',\n                  height: 'auto',\n                  display: 'block'\n                }}\n              />\n              <div style={{\n                position: 'absolute',\n                top: '0.5rem',\n                left: '0.5rem',\n                background: 'rgba(0,0,0,0.7)',\n                color: 'white',\n                padding: '0.25rem 0.5rem',\n                borderRadius: '0.25rem',\n                fontSize: '0.75rem',\n                fontWeight: '500'\n              }}>\n                変換済み\n              </div>\n            </div>\n          </div>\n        )}\n        \n        {viewMode === 'original' && (\n          <div style={{ display: 'flex', justifyContent: 'center' }}>\n            <canvas\n              ref={originalCanvasRef}\n              style={{\n                maxWidth: '100%',\n                height: 'auto',\n                display: 'block'\n              }}\n            />\n          </div>\n        )}\n        \n        {viewMode === 'processed' && (\n          <div style={{ display: 'flex', justifyContent: 'center' }}>\n            <canvas\n              ref={processedCanvasRef}\n              style={{\n                maxWidth: '100%',\n                height: 'auto',\n                display: 'block'\n              }}\n            />\n          </div>\n        )}\n      </div>\n\n      <div style={{\n        marginTop: '1rem',\n        padding: '1rem',\n        background: '#F0F9FF',\n        borderRadius: '0.5rem',\n        border: '1px solid #BFDBFE'\n      }}>\n        <p style={{\n          fontSize: '0.875rem',\n          color: '#374151',\n          margin: '0',\n          lineHeight: '1.5'\n        }}>\n          🔄 <strong>リアルタイム処理:</strong> 左のスライダー調整が即座に反映されます<br />\n          💾 <strong>ダウンロード:</strong> 処理結果をPNG形式で保存できます\n        </p>\n      </div>\n    </div>\n  );\n};","import React, { useRef, useEffect, useState, useCallback } from 'react';\nimport type { CameraConfig, ColorVisionSettings } from '../types/color';\nimport { processImageData, drawImageDataToCanvas, downloadCanvasAsImage } from '../utils/image-processor';\n\ninterface CameraCaptureProps {\n  colorVisionSettings: ColorVisionSettings;\n  onProcessingStateChange: (isProcessing: boolean, progress: number, error?: string) => void;\n}\n\n/**\n * カメラキャプチャ・リアルタイム処理コンポーネント\n */\nexport const CameraCapture: React.FC<CameraCaptureProps> = ({\n  colorVisionSettings,\n  onProcessingStateChange\n}) => {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const originalCanvasRef = useRef<HTMLCanvasElement>(null);\n  const processedCanvasRef = useRef<HTMLCanvasElement>(null);\n  \n  const [cameraConfig, setCameraConfig] = useState<CameraConfig>({\n    isActive: false,\n    facingMode: 'environment',\n    resolution: { width: 1280, height: 720 }\n  });\n  \n  const [devices, setDevices] = useState<MediaDeviceInfo[]>([]);\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  const [isProcessingFrame, setIsProcessingFrame] = useState(false);\n  const [viewMode, setViewMode] = useState<'original' | 'processed' | 'split'>('processed');\n  \n  // カメラデバイス一覧を取得\n  useEffect(() => {\n    const getDevices = async () => {\n      try {\n        const deviceList = await navigator.mediaDevices.enumerateDevices();\n        const videoDevices = deviceList.filter(device => device.kind === 'videoinput');\n        setDevices(videoDevices);\n      } catch (error) {\n        console.error('デバイス取得エラー:', error);\n      }\n    };\n    \n    getDevices();\n  }, []);\n\n  // カメラストリーム開始/停止\n  const toggleCamera = useCallback(async () => {\n    console.log('toggleCamera called, current state:', cameraConfig.isActive);\n    \n    if (cameraConfig.isActive && stream) {\n      // カメラ停止\n      console.log('Stopping camera...');\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n      setCameraConfig(prev => ({ ...prev, isActive: false }));\n      return;\n    }\n\n    // getUserMedia対応チェック\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      console.error('getUserMedia not supported');\n      onProcessingStateChange(false, 0, 'お使いのブラウザはカメラアクセスに対応していません');\n      return;\n    }\n\n    try {\n      console.log('Starting camera...');\n      onProcessingStateChange(true, 0, '');\n      \n      // シンプルな設定でまず試す\n      const constraints = {\n        video: cameraConfig.deviceId \n          ? { deviceId: { exact: cameraConfig.deviceId } }\n          : { facingMode: cameraConfig.facingMode }\n      };\n      \n      console.log('Camera constraints:', constraints);\n      \n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n      console.log('Camera stream obtained:', mediaStream);\n      \n      setStream(mediaStream);\n      setCameraConfig(prev => ({ ...prev, isActive: true }));\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = mediaStream;\n        console.log('Video element source set');\n        \n        // video要素の準備完了を待つ\n        videoRef.current.onloadedmetadata = () => {\n          console.log('Video metadata loaded');\n          onProcessingStateChange(false, 100, '');\n        };\n      }\n    } catch (error) {\n      console.error('カメラアクセスエラー:', error);\n      \n      let errorMessage = 'カメラにアクセスできませんでした';\n      if (error instanceof Error) {\n        if (error.name === 'NotAllowedError') {\n          errorMessage = 'カメラアクセスが拒否されました。ブラウザの設定を確認してください';\n        } else if (error.name === 'NotFoundError') {\n          errorMessage = 'カメラが見つかりませんでした';\n        } else if (error.name === 'NotReadableError') {\n          errorMessage = 'カメラが他のアプリケーションで使用中です';\n        } else {\n          errorMessage = `カメラエラー: ${error.message}`;\n        }\n      }\n      \n      onProcessingStateChange(false, 0, errorMessage);\n    }\n  }, [cameraConfig, stream, onProcessingStateChange]);\n\n  // 静止画キャプチャ・処理\n  const captureAndProcess = useCallback(async () => {\n    if (!videoRef.current || !originalCanvasRef.current || !processedCanvasRef.current) return;\n    if (isProcessingFrame) return;\n    \n    const video = videoRef.current;\n    const originalCanvas = originalCanvasRef.current;\n    const processedCanvas = processedCanvasRef.current;\n    \n    // ビデオフレームをcanvasに描画\n    originalCanvas.width = video.videoWidth;\n    originalCanvas.height = video.videoHeight;\n    processedCanvas.width = video.videoWidth;\n    processedCanvas.height = video.videoHeight;\n    \n    const ctx = originalCanvas.getContext('2d');\n    if (!ctx) return;\n    \n    ctx.drawImage(video, 0, 0);\n    const imageData = ctx.getImageData(0, 0, originalCanvas.width, originalCanvas.height);\n    \n    setIsProcessingFrame(true);\n    onProcessingStateChange(true, 50, '画像を処理中...');\n    \n    try {\n      // 色変換処理を適用\n      const processedImageData = await processImageData(imageData, colorVisionSettings);\n      drawImageDataToCanvas(processedCanvas, processedImageData);\n      onProcessingStateChange(false, 100, '処理完了');\n    } catch (error) {\n      console.error('フレーム処理エラー:', error);\n      onProcessingStateChange(false, 0, '処理中にエラーが発生しました');\n    } finally {\n      setIsProcessingFrame(false);\n    }\n  }, [colorVisionSettings, isProcessingFrame, onProcessingStateChange]);\n\n  // キャプチャ機能\n  const capturePhoto = useCallback(() => {\n    if (!processedCanvasRef.current) return;\n    \n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n    const filename = `colorwise-capture-${timestamp}.png`;\n    downloadCanvasAsImage(processedCanvasRef.current, filename);\n  }, []);\n\n  return (\n    <div style={{\n      background: '#FFFFFF',\n      borderRadius: '0.75rem',\n      padding: '1.5rem',\n      boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\n      width: '100%'\n    }}>\n      <div style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '1.5rem',\n        flexWrap: 'wrap',\n        gap: '1rem'\n      }}>\n        <h3 style={{\n          fontSize: '1.25rem',\n          fontWeight: '600',\n          color: '#111827',\n          margin: '0'\n        }}>\n          📷 カメラキャプチャ\n        </h3>\n        \n        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n          {devices.length > 1 && (\n            <select\n              value={cameraConfig.deviceId || ''}\n              onChange={(e) => setCameraConfig(prev => ({ ...prev, deviceId: e.target.value }))}\n              disabled={cameraConfig.isActive}\n              style={{\n                padding: '0.5rem',\n                border: '1px solid #D1D5DB',\n                borderRadius: '0.375rem',\n                fontSize: '0.875rem'\n              }}\n            >\n              <option value=\"\">デフォルト</option>\n              {devices.map(device => (\n                <option key={device.deviceId} value={device.deviceId}>\n                  {device.label || `カメラ ${device.deviceId.slice(0, 8)}`}\n                </option>\n              ))}\n            </select>\n          )}\n          \n          <select\n            value={viewMode}\n            onChange={(e) => setViewMode(e.target.value as any)}\n            style={{\n              padding: '0.5rem',\n              border: '1px solid #D1D5DB',\n              borderRadius: '0.375rem',\n              fontSize: '0.875rem'\n            }}\n          >\n            <option value=\"original\">元画像</option>\n            <option value=\"processed\">変換済み</option>\n            <option value=\"split\">分割表示</option>\n          </select>\n          \n          <button\n            onClick={toggleCamera}\n            style={{\n              background: cameraConfig.isActive ? '#DC2626' : '#10B981',\n              color: 'white',\n              padding: '0.5rem 1rem',\n              borderRadius: '0.375rem',\n              fontWeight: '500',\n              border: 'none',\n              cursor: 'pointer',\n              fontSize: '0.875rem'\n            }}\n          >\n            {cameraConfig.isActive ? '⏹️ 停止' : '📹 カメラを起動'}\n          </button>\n          \n          {cameraConfig.isActive && (\n            <>\n              <button\n                onClick={captureAndProcess}\n                disabled={isProcessingFrame}\n                style={{\n                  background: isProcessingFrame ? '#9CA3AF' : '#059669',\n                  color: 'white',\n                  padding: '0.5rem 1rem',\n                  borderRadius: '0.375rem',\n                  fontWeight: '500',\n                  border: 'none',\n                  cursor: isProcessingFrame ? 'not-allowed' : 'pointer',\n                  fontSize: '0.875rem'\n                }}\n              >\n                {isProcessingFrame ? '🔄 処理中...' : '📸 撮影'}\n              </button>\n              \n              <button\n                onClick={capturePhoto}\n                disabled={!processedCanvasRef.current}\n                style={{\n                  background: '#3B82F6',\n                  color: 'white',\n                  padding: '0.5rem 1rem',\n                  borderRadius: '0.375rem',\n                  fontWeight: '500',\n                  border: 'none',\n                  cursor: 'pointer',\n                  fontSize: '0.875rem'\n                }}\n              >\n                💾 保存\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      <div style={{\n        borderRadius: '0.5rem',\n        overflow: 'auto',\n        background: '#F3F4F6',\n        position: 'relative',\n        minHeight: '400px',\n        maxHeight: '80vh'\n      }}>\n        {!cameraConfig.isActive ? (\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            height: '300px',\n            flexDirection: 'column',\n            gap: '1rem'\n          }}>\n            <div style={{ fontSize: '3rem' }}>📹</div>\n            <p style={{\n              color: '#6B7280',\n              fontSize: '1.125rem',\n              margin: '0'\n            }}>\n              カメラを起動してください\n            </p>\n          </div>\n        ) : (\n          <>\n            <video\n              ref={videoRef}\n              autoPlay\n              playsInline\n              muted\n              style={{\n                display: 'none'\n              }}\n            />\n            \n            {viewMode === 'split' && (\n              <div style={{ display: 'flex', gap: '4px', justifyContent: 'center' }}>\n                <div style={{ position: 'relative' }}>\n                  <canvas\n                    ref={originalCanvasRef}\n                    style={{\n                      maxWidth: '100%',\n                      height: 'auto',\n                      display: 'block'\n                    }}\n                  />\n                  <div style={{\n                    position: 'absolute',\n                    top: '0.5rem',\n                    left: '0.5rem',\n                    background: 'rgba(0,0,0,0.7)',\n                    color: 'white',\n                    padding: '0.25rem 0.5rem',\n                    borderRadius: '0.25rem',\n                    fontSize: '0.75rem',\n                    fontWeight: '500'\n                  }}>\n                    オリジナル\n                  </div>\n                </div>\n                <div style={{ position: 'relative' }}>\n                  <canvas\n                    ref={processedCanvasRef}\n                    style={{\n                      maxWidth: '100%',\n                      height: 'auto',\n                      display: 'block'\n                    }}\n                  />\n                  <div style={{\n                    position: 'absolute',\n                    top: '0.5rem',\n                    left: '0.5rem',\n                    background: 'rgba(0,0,0,0.7)',\n                    color: 'white',\n                    padding: '0.25rem 0.5rem',\n                    borderRadius: '0.25rem',\n                    fontSize: '0.75rem',\n                    fontWeight: '500'\n                  }}>\n                    処理後\n                  </div>\n                  {isProcessingFrame && (\n                    <div style={{\n                      position: 'absolute',\n                      top: '0.5rem',\n                      right: '0.5rem',\n                      background: 'rgba(0,0,0,0.7)',\n                      color: 'white',\n                      padding: '0.25rem 0.5rem',\n                      borderRadius: '0.25rem',\n                      fontSize: '0.75rem'\n                    }}>\n                      処理中...\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            \n            {viewMode === 'original' && (\n              <div style={{ display: 'flex', justifyContent: 'center' }}>\n                <canvas\n                  ref={originalCanvasRef}\n                  style={{\n                    maxWidth: '100%',\n                    height: 'auto',\n                    display: 'block'\n                  }}\n                />\n              </div>\n            )}\n            \n            {viewMode === 'processed' && (\n              <div style={{ display: 'flex', justifyContent: 'center' }}>\n                <canvas\n                  ref={processedCanvasRef}\n                  style={{\n                    maxWidth: '100%',\n                    height: 'auto',\n                    display: 'block'\n                  }}\n                />\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      <div style={{\n        marginTop: '1rem',\n        padding: '1rem',\n        background: '#F0F9FF',\n        borderRadius: '0.5rem',\n        border: '1px solid #BFDBFE'\n      }}>\n        <p style={{\n          fontSize: '0.875rem',\n          color: '#374151',\n          margin: '0 0 0.5rem 0',\n          lineHeight: '1.5'\n        }}>\n          📸 <strong>撮影:</strong> 「撮影」ボタンで静止画をキャプチャし、色覚変換を適用<br />\n          💾 <strong>保存:</strong> 処理後の画像をPNG形式でダウンロードできます\n        </p>\n        <p style={{\n          fontSize: '0.75rem',\n          color: '#6B7280',\n          margin: '0',\n          lineHeight: '1.4',\n          fontStyle: 'italic'\n        }}>\n          ⚠️ <strong>カメラアクセスのヒント:</strong><br />\n          • ブラウザでカメラ許可が必要です<br />\n          • 他のアプリでカメラを使用中でないか確認してください<br />\n          • HTTPSでない場合、一部ブラウザで制限される場合があります\n        </p>\n      </div>\n    </div>\n  );\n};","import React from 'react';\n\ninterface AboutModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  activeSection: 'about' | 'credits' | 'privacy' | 'disclaimer';\n}\n\nexport const AboutModal: React.FC<AboutModalProps> = ({ isOpen, onClose, activeSection }) => {\n  if (!isOpen) return null;\n\n  const renderContent = () => {\n    switch (activeSection) {\n      case 'about':\n        return (\n          <div>\n            <h2 style={{ color: '#111827', marginBottom: '1rem' }}>このアプリについて</h2>\n            <div style={{ lineHeight: '1.6', color: '#374151' }}>\n              <p><strong>ColorWise（カラーワイズ）</strong>は、色覚の多様性に配慮した色表示支援ツールです。</p>\n              \n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🎯 目的</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>色覚の違いによる見え方の体験・理解促進</li>\n                <li>デジタルコンテンツの色調整支援</li>\n                <li>より包括的なデザイン環境の実現</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>⚠️ 重要な注意</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>本アプリは医療機器ではありません</li>\n                <li>色覚異常の診断・治療を目的としていません</li>\n                <li>医師の診断に代わるものではありません</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🔒 プライバシー</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>すべての処理は端末内で完結</li>\n                <li>画像データの外部送信なし</li>\n                <li>個人情報の収集なし</li>\n              </ul>\n            </div>\n          </div>\n        );\n      \n      case 'credits':\n        return (\n          <div>\n            <h2 style={{ color: '#111827', marginBottom: '1rem' }}>クレジット・謝辞</h2>\n            <div style={{ lineHeight: '1.6', color: '#374151' }}>\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🎓 学術的基盤</h3>\n              <p>本アプリの色覚シミュレーション機能は、以下の研究成果を参考に実装されています：</p>\n              <div style={{ \n                background: '#F9FAFB', \n                padding: '1rem', \n                borderRadius: '0.5rem', \n                border: '1px solid #E5E7EB',\n                marginTop: '0.5rem'\n              }}>\n                <p style={{ fontWeight: 'bold', margin: '0 0 0.5rem 0' }}>\n                  Machado, G.M., Oliveira, M.M., and Fernandes, L.A.F. (2009)\n                </p>\n                <p style={{ fontStyle: 'italic', margin: '0 0 0.5rem 0' }}>\n                  \"A Physiologically-based Model for Simulation of Color Vision Deficiency\"\n                </p>\n                <p style={{ fontSize: '0.875rem', margin: '0' }}>\n                  IEEE Transactions on Visualization and Computer Graphics, Vol.15, No.6, pp.1291-1298\n                </p>\n              </div>\n              \n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🛠️ 技術スタック</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>React 18 + TypeScript</li>\n                <li>Vite (ビルドツール)</li>\n                <li>PWA (Service Worker + Manifest)</li>\n                <li>Canvas API (画像処理)</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🙏 謝辞</h3>\n              <p>\n                色覚の多様性に関する理解促進と、より包括的な技術環境の構築に貢献してくださる\n                研究者・開発者・コミュニティの皆様に深く感謝いたします。\n              </p>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>☕ 開発を支援</h3>\n              <p style={{ marginBottom: '1rem' }}>\n                このアプリが役に立ちましたら、開発継続のためのご支援をいただけると大変嬉しいです（完全任意です）。\n              </p>\n              <div style={{ textAlign: 'center' }}>\n                <a\n                  href=\"https://github.com/sponsors\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  style={{\n                    display: 'inline-block',\n                    background: '#EA4AAA',\n                    color: 'white',\n                    padding: '0.75rem 1.5rem',\n                    borderRadius: '0.5rem',\n                    textDecoration: 'none',\n                    fontWeight: '500',\n                    transition: 'background 0.2s'\n                  }}\n                >\n                  💝 GitHub Sponsors で支援\n                </a>\n              </div>\n              <p style={{ \n                fontSize: '0.75rem', \n                color: '#6B7280', \n                textAlign: 'center', \n                margin: '0.5rem 0 0 0' \n              }}>\n                ※ 機能制限はありません。すべて任意のサポートです。\n              </p>\n            </div>\n          </div>\n        );\n      \n      case 'privacy':\n        return (\n          <div>\n            <h2 style={{ color: '#111827', marginBottom: '1rem' }}>プライバシーポリシー</h2>\n            <div style={{ lineHeight: '1.6', color: '#374151' }}>\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🔒 データ収集について</h3>\n              <p><strong>本アプリは以下のデータを一切収集しません：</strong></p>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>個人識別情報</li>\n                <li>画像・写真データ</li>\n                <li>位置情報</li>\n                <li>閲覧履歴</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>💾 ローカルデータ</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>設定情報のみをブラウザ内に保存</li>\n                <li>外部サーバーへの送信なし</li>\n                <li>ブラウザ設定から削除可能</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>📷 カメラ機能</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>すべての処理が端末内で完結</li>\n                <li>撮影データの外部送信なし</li>\n                <li>アプリ終了時に自動削除</li>\n              </ul>\n\n              <p style={{ \n                background: '#EFF6FF', \n                padding: '1rem', \n                borderRadius: '0.5rem',\n                border: '1px solid #DBEAFE',\n                marginTop: '1rem'\n              }}>\n                詳細は <a href=\"/PRIVACY.md\" target=\"_blank\" rel=\"noopener noreferrer\" style={{ color: '#3B82F6' }}>\n                  完全版プライバシーポリシー\n                </a> をご確認ください。\n              </p>\n            </div>\n          </div>\n        );\n      \n      case 'disclaimer':\n        return (\n          <div>\n            <h2 style={{ color: '#111827', marginBottom: '1rem' }}>免責事項</h2>\n            <div style={{ lineHeight: '1.6', color: '#374151' }}>\n              <div style={{ \n                background: '#FEF3C7', \n                padding: '1rem', \n                borderRadius: '0.5rem',\n                border: '1px solid #FCD34D',\n                marginBottom: '1rem'\n              }}>\n                <p style={{ margin: 0, fontWeight: 'bold' }}>\n                  ⚠️ 重要：本アプリケーションは医療機器ではありません\n                </p>\n              </div>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>❌ 本アプリは以下ではありません</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>色覚異常の診断ツール</li>\n                <li>治療を目的とした製品</li>\n                <li>医師による診断・治療の代替手段</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>✅ 本アプリの目的</h3>\n              <ul style={{ paddingLeft: '1.5rem' }}>\n                <li>色覚の違いによる見え方の体験・理解促進</li>\n                <li>デジタルコンテンツの色調整支援</li>\n                <li>アクセシビリティ向上のための支援</li>\n              </ul>\n\n              <h3 style={{ marginTop: '1.5rem', marginBottom: '0.5rem' }}>🏥 医療相談の推奨</h3>\n              <p>色覚に関する疑問や不安がある場合は、必ず専門の眼科医師にご相談ください。</p>\n\n              <p style={{ \n                background: '#FEF2F2', \n                padding: '1rem', \n                borderRadius: '0.5rem',\n                border: '1px solid #FECACA',\n                marginTop: '1rem'\n              }}>\n                詳細は <a href=\"/DISCLAIMER.md\" target=\"_blank\" rel=\"noopener noreferrer\" style={{ color: '#3B82F6' }}>\n                  完全版免責事項\n                </a> をご確認ください。\n              </p>\n            </div>\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div style={{\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 1000,\n      padding: '1rem'\n    }}>\n      <div style={{\n        backgroundColor: 'white',\n        borderRadius: '0.75rem',\n        padding: '2rem',\n        maxWidth: '600px',\n        maxHeight: '80vh',\n        overflow: 'auto',\n        position: 'relative',\n        boxShadow: '0 20px 25px -5px rgb(0 0 0 / 0.1), 0 10px 10px -5px rgb(0 0 0 / 0.04)'\n      }}>\n        <button\n          onClick={onClose}\n          style={{\n            position: 'absolute',\n            top: '1rem',\n            right: '1rem',\n            background: 'none',\n            border: 'none',\n            fontSize: '1.5rem',\n            cursor: 'pointer',\n            color: '#6B7280',\n            width: '2rem',\n            height: '2rem',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center'\n          }}\n        >\n          ×\n        </button>\n        \n        {renderContent()}\n      </div>\n    </div>\n  );\n};","import React from 'react';\r\n\r\ninterface ColorWheelIconProps {\r\n  size?: 'small' | 'medium' | 'large' | number;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n}\r\n\r\n/**\r\n * 12色の円環アイコンコンポーネント\r\n */\r\nexport const ColorWheelIcon: React.FC<ColorWheelIconProps> = ({ \r\n  size = 'medium', \r\n  className = '', \r\n  style = {} \r\n}) => {\r\n  const getSize = () => {\r\n    if (typeof size === 'number') return size;\r\n    switch (size) {\r\n      case 'small': return 24;\r\n      case 'medium': return 32;\r\n      case 'large': return 48;\r\n      default: return 32;\r\n    }\r\n  };\r\n\r\n  const iconSize = getSize();\r\n\r\n  return (\r\n    <svg\r\n      width={iconSize}\r\n      height={iconSize}\r\n      viewBox=\"0 0 512 512\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={className}\r\n      style={{ \r\n        ...style,\r\n        shapeRendering: 'geometricPrecision',\r\n        imageRendering: 'optimizeQuality' as any,\r\n        filter: 'drop-shadow(0 0 8px rgba(255, 255, 255, 0.4))'\r\n      }}\r\n    >\r\n      <defs>\r\n        {/* フレア効果フィルター */}\r\n        <filter id=\"flare\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\r\n          <feGaussianBlur stdDeviation=\"2\" result=\"coloredBlur\"/>\r\n          <feMerge>\r\n            <feMergeNode in=\"coloredBlur\"/>\r\n            <feMergeNode in=\"SourceGraphic\"/>\r\n          </feMerge>\r\n        </filter>\r\n        \r\n        {/* 各色のグラデーション定義 */}\r\n        <radialGradient id=\"purpleGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(270, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(270, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(270, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"magentaGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(300, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(300, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(300, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"pinkGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(330, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(330, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(330, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"redGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(0, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(0, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(0, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"orangeGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(30, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(30, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(30, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"yellowGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(60, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(60, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(60, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"yellowGreenGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(90, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(90, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(90, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"greenGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(120, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(120, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(120, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"blueGreenGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(150, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(150, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(150, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"cyanGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(180, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(180, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(180, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"lightBlueGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(210, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(210, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(210, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n        <radialGradient id=\"blueGlow\">\r\n          <stop offset=\"0%\" stopColor=\"hsl(240, 85%, 75%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"70%\" stopColor=\"hsl(240, 85%, 60%)\" stopOpacity=\"1\"/>\r\n          <stop offset=\"100%\" stopColor=\"hsl(240, 85%, 50%)\" stopOpacity=\"1\"/>\r\n        </radialGradient>\r\n      </defs>\r\n      \r\n      {/* 12色の円を正確な円環状に配置（赤を3時の位置に）- フレア効果付き */}\r\n      {/* 中心(256,256)、半径150pxの円周上に12個の円を30度間隔で配置 */}\r\n      <circle cx=\"256\" cy=\"106\" r=\"32\" fill=\"url(#purpleGlow)\" filter=\"url(#flare)\"/> {/* 12時: 紫 */}\r\n      <circle cx=\"331\" cy=\"131\" r=\"32\" fill=\"url(#magentaGlow)\" filter=\"url(#flare)\"/> {/* 1時: マゼンタ */}\r\n      <circle cx=\"385.8\" cy=\"181\" r=\"32\" fill=\"url(#pinkGlow)\" filter=\"url(#flare)\"/> {/* 2時: ピンク */}\r\n      <circle cx=\"406\" cy=\"256\" r=\"32\" fill=\"url(#redGlow)\" filter=\"url(#flare)\"/> {/* 3時: 赤 */}\r\n      <circle cx=\"385.8\" cy=\"331\" r=\"32\" fill=\"url(#orangeGlow)\" filter=\"url(#flare)\"/> {/* 4時: オレンジ */}\r\n      <circle cx=\"331\" cy=\"381\" r=\"32\" fill=\"url(#yellowGlow)\" filter=\"url(#flare)\"/> {/* 5時: 黄 */}\r\n      <circle cx=\"256\" cy=\"406\" r=\"32\" fill=\"url(#yellowGreenGlow)\" filter=\"url(#flare)\"/> {/* 6時: 黄緑 */}\r\n      <circle cx=\"181\" cy=\"381\" r=\"32\" fill=\"url(#greenGlow)\" filter=\"url(#flare)\"/> {/* 7時: 緑 */}\r\n      <circle cx=\"126.2\" cy=\"331\" r=\"32\" fill=\"url(#blueGreenGlow)\" filter=\"url(#flare)\"/> {/* 8時: 青緑 */}\r\n      <circle cx=\"106\" cy=\"256\" r=\"32\" fill=\"url(#cyanGlow)\" filter=\"url(#flare)\"/> {/* 9時: シアン */}\r\n      <circle cx=\"126.2\" cy=\"181\" r=\"32\" fill=\"url(#lightBlueGlow)\" filter=\"url(#flare)\"/> {/* 10時: 水色 */}\r\n      <circle cx=\"181\" cy=\"131\" r=\"32\" fill=\"url(#blueGlow)\" filter=\"url(#flare)\"/> {/* 11時: 青 */}\r\n    </svg>\r\n  );\r\n};","import { useState, useEffect, useCallback } from 'react';\r\nimport { ColorCircles } from '@components/ColorCircles';\r\nimport { ColorAdjuster } from '@components/ColorAdjuster';\r\nimport { ImageUploader } from '@components/ImageUploader';\r\nimport { ImageViewer } from '@components/ImageViewer';\r\nimport { CameraCapture } from '@components/CameraCapture';\r\nimport { AboutModal } from '@components/AboutModal';\r\nimport { ColorWheelIcon } from '@components/ColorWheelIcon';\r\nimport type { ColorVisionSettings, ImageFileInfo, ImageProcessingState } from './types/color';\r\nimport './App.css';\r\n\r\n/**\r\n * ColorWise メインアプリケーションコンポーネント\r\n */\r\nfunction App() {\r\n\r\n  const [colorVisionSettings, setColorVisionSettings] = useState<ColorVisionSettings>({\r\n    simulation: {\r\n      useSimulation: false,\r\n      simulationType: 'deuteranopia',\r\n      severity: 0.2,\r\n      showSimulationInfo: false,\r\n    },\r\n    correction: {\r\n      useCorrection: false,\r\n      correctionType: 'deuteranopia',\r\n      strength: 0.2,\r\n    },\r\n    specialEffect: {\r\n      enabled: false,\r\n      type: 'double-light',\r\n      intensity: 0.5,\r\n      details: {\r\n        doubleLight: {\r\n          light1Position: { x: 0.25, y: 0.25 },\r\n          light2Position: { x: 0.75, y: 0.75 }\r\n        },\r\n        glitch: {\r\n          offsetAmount: 2,\r\n          noiseLevel: 0.1\r\n        },\r\n        depth: {\r\n          focusedRing: undefined\r\n        },\r\n        munker: {\r\n          stripeWidth: 8,\r\n          stripePattern: 'red-green'\r\n        },\r\n        watercolor: {\r\n          blurRadius: 5,\r\n          spreadAmount: 0.3\r\n        }\r\n      }\r\n    },\r\n  });\r\n\r\n  // 画像・カメラ機能の状態\r\n  const [currentTab, setCurrentTab] = useState<'rgb' | 'image' | 'camera'>('rgb');\r\n\r\n  // モーダル関連の状態\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [modalSection, setModalSection] = useState<'about' | 'credits' | 'privacy' | 'disclaimer'>('about');\r\n  const [imageInfo, setImageInfo] = useState<ImageFileInfo | null>(null);\r\n  const [processingState, setProcessingState] = useState<ImageProcessingState>({\r\n    isProcessing: false,\r\n    progress: 0,\r\n    error: null\r\n  });\r\n\r\n  // ウィンドウサイズの管理\r\n  const [windowWidth, setWindowWidth] = useState<number>(window.innerWidth);\r\n\r\n  // 処理状態変更ハンドラ（useCallbackでメモ化）\r\n  const handleProcessingStateChange = useCallback((isProcessing: boolean, progress: number, error?: string) => {\r\n    setProcessingState({\r\n      isProcessing,\r\n      progress,\r\n      error: error || null\r\n    });\r\n  }, []);\r\n\r\n  // ウィンドウサイズの変更を監視\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setWindowWidth(window.innerWidth);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  // ローカルストレージから設定を読み込み\r\n  useEffect(() => {\r\n    const savedColorVisionSettings = localStorage.getItem('colorwise-color-vision-settings');\r\n    if (savedColorVisionSettings) {\r\n      try {\r\n        const parsed = JSON.parse(savedColorVisionSettings);\r\n        setColorVisionSettings(parsed);\r\n      } catch (error) {\r\n        console.error('色覚設定の読み込みに失敗しました:', error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // 設定が変更されたらローカルストレージに保存\r\n  useEffect(() => {\r\n    localStorage.setItem('colorwise-color-vision-settings', JSON.stringify(colorVisionSettings));\r\n  }, [colorVisionSettings]);\r\n\r\n  // モーダル制御ハンドラー\r\n  const openModal = (section: 'about' | 'credits' | 'privacy' | 'disclaimer') => {\r\n    setModalSection(section);\r\n    setShowModal(true);\r\n  };\r\n\r\n  const closeModal = () => {\r\n    setShowModal(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <header className=\"app-header\">\r\n        <div className=\"container\">\r\n          <h1 className=\"app-title\">\r\n            <ColorWheelIcon size=\"large\" className=\"app-logo\" />\r\n            ColorWise\r\n          </h1>\r\n          <p className=\"app-subtitle\">\r\n            ColorWise - 色の世界を、もっと楽しく\r\n          </p>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"app-main\">\r\n        {/* タブナビゲーション */}\r\n        <nav className=\"tab-navigation\">\r\n          <div className=\"tab-buttons\">\r\n            <button\r\n              onClick={() => setCurrentTab('rgb')}\r\n              className={`tab-button ${currentTab === 'rgb' ? 'active' : ''}`}\r\n            >\r\n              <ColorWheelIcon size=\"small\" style={{ marginRight: '0.5rem', verticalAlign: 'middle' }} />\r\n              色のプレビュー\r\n            </button>\r\n            <button\r\n              onClick={() => setCurrentTab('image')}\r\n              className={`tab-button ${currentTab === 'image' ? 'active' : ''}`}\r\n            >\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\" style={{ marginRight: '0.5rem', verticalAlign: 'middle' }}>\r\n                <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n                <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n              </svg>\r\n              写真\r\n            </button>\r\n            <button\r\n              onClick={() => setCurrentTab('camera')}\r\n              className={`tab-button ${currentTab === 'camera' ? 'active' : ''}`}\r\n            >\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" style={{ marginRight: '0.5rem', verticalAlign: 'middle' }}>\r\n                <path d=\"M14.5 4h-5L7 7H4a2 2 0 00-2 2v9a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2h-3l-2.5-3z\"/>\r\n                <circle cx=\"12\" cy=\"13\" r=\"3\"/>\r\n              </svg>\r\n              カメラ\r\n            </button>\r\n          </div>\r\n        </nav>\r\n        \r\n        <div className=\"container\">\r\n          <div className={currentTab === 'rgb' ? 'app-content' : ''}>\r\n            {/* RGB調整タブ */}\r\n            {currentTab === 'rgb' && (\r\n              <>\r\n                <section className=\"visualization-section\">\r\n                  <div className=\"visualization-wrapper\">\r\n                    <ColorCircles \r\n                      colorVisionSettings={colorVisionSettings}\r\n                    />\r\n                  </div>\r\n                  <div className=\"section-description\">\r\n                    <p>\r\n                      24色相環で様々な色の見え方を、色覚シミュレーションや補正の効果をリアルタイムでプレビューできます。\r\n                      設定パネルで調整してください。\r\n                    </p>\r\n                  </div>\r\n                </section>\r\n\r\n                <section className=\"adjustment-section\">\r\n                  <ColorAdjuster\r\n                    colorVisionSettings={colorVisionSettings}\r\n                    onColorVisionSettingsChange={setColorVisionSettings}\r\n                  />\r\n                </section>\r\n              </>\r\n            )}\r\n\r\n            {/* 写真処理タブ */}\r\n            {currentTab === 'image' && (\r\n              <div style={{ \r\n                display: 'grid', \r\n                gridTemplateColumns: windowWidth > 768 ? '350px 1fr' : '1fr', \r\n                gap: '2rem',\r\n                alignItems: 'start'\r\n              }}>\r\n                <div style={{ \r\n                  position: windowWidth > 1400 ? 'sticky' : 'static',\r\n                  top: '1rem'\r\n                }}>\r\n                  <h2 className=\"section-title\" style={{ color: '#9CA3AF', marginBottom: '1rem' }}>Settings</h2>\r\n                  <ColorAdjuster\r\n                    colorVisionSettings={colorVisionSettings}\r\n                    onColorVisionSettingsChange={setColorVisionSettings}\r\n                  />\r\n                  <div style={{ marginTop: '2rem' }}>\r\n                    <ImageUploader\r\n                      onImageLoad={setImageInfo}\r\n                      processingState={processingState}\r\n                      disabled={processingState.isProcessing}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div style={{ width: '100%' }}>\r\n                  <ImageViewer\r\n                    imageInfo={imageInfo}\r\n                    colorVisionSettings={colorVisionSettings}\r\n                    onProcessingStateChange={handleProcessingStateChange}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* カメラタブ */}\r\n            {currentTab === 'camera' && (\r\n              <div style={{ \r\n                display: 'grid', \r\n                gridTemplateColumns: windowWidth > 768 ? '350px 1fr' : '1fr', \r\n                gap: '2rem',\r\n                alignItems: 'start'\r\n              }}>\r\n                <div style={{ \r\n                  position: windowWidth > 1400 ? 'sticky' : 'static',\r\n                  top: '1rem'\r\n                }}>\r\n                  <h2 className=\"section-title\" style={{ color: '#9CA3AF', marginBottom: '1rem' }}>Settings</h2>\r\n                  <ColorAdjuster\r\n                    colorVisionSettings={colorVisionSettings}\r\n                    onColorVisionSettingsChange={setColorVisionSettings}\r\n                  />\r\n                </div>\r\n                <div style={{ width: '100%' }}>\r\n                  <CameraCapture\r\n                    colorVisionSettings={colorVisionSettings}\r\n                    onProcessingStateChange={handleProcessingStateChange}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n        </div>\r\n      </main>\r\n\r\n      <footer className=\"app-footer\">\r\n        <div className=\"container\">\r\n          <p className=\"footer-text\">\r\n            © 2025 ColorWise - 色の世界を、もっと楽しく\r\n          </p>\r\n          <p className=\"footer-links\">\r\n            <button onClick={() => openModal('about')} className=\"footer-link\" style={{ background: 'none', border: 'none', color: 'inherit', textDecoration: 'underline', cursor: 'pointer' }}>このアプリについて</button>\r\n            <span className=\"footer-separator\">|</span>\r\n            <button onClick={() => openModal('credits')} className=\"footer-link\" style={{ background: 'none', border: 'none', color: 'inherit', textDecoration: 'underline', cursor: 'pointer' }}>クレジット</button>\r\n            <span className=\"footer-separator\">|</span>\r\n            <button onClick={() => openModal('privacy')} className=\"footer-link\" style={{ background: 'none', border: 'none', color: 'inherit', textDecoration: 'underline', cursor: 'pointer' }}>プライバシーポリシー</button>\r\n            <span className=\"footer-separator\">|</span>\r\n            <button onClick={() => openModal('disclaimer')} className=\"footer-link\" style={{ background: 'none', border: 'none', color: 'inherit', textDecoration: 'underline', cursor: 'pointer' }}>免責事項</button>\r\n          </p>\r\n        </div>\r\n      </footer>\r\n\r\n      <AboutModal \r\n        isOpen={showModal}\r\n        onClose={closeModal}\r\n        activeSection={modalSection}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.tsx'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)\n\n// Service Worker registration\nif ('serviceWorker' in navigator) {\n  window.addEventListener('load', () => {\n    navigator.serviceWorker.register('/sw.js')\n      .then((registration) => {\n        console.log('SW registered: ', registration);\n      })\n      .catch((registrationError) => {\n        console.log('SW registration failed: ', registrationError);\n      });\n  });\n}"],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","srgbToLinear","linearToSrgb","applyMat3","v","x","y","z","clamp01","clamp255","polyfitLeastSquares","xs","ys","degree","A","i","val","j","AT","transpose","ATA","matMul","ATb","matVecMul","gaussianSolve","M","rows","cols","T","B","r","out","sum","t","Ain","bIn","row","maxRow","pivot","factor","MACHADO_DEUTERANOMALY","buildPolynomialCoeffs","data","coeffs","evalPoly","acc","evaluateMatrix","s","ss","DEGREE","COEFFS","simulateDeutanPoly","rgb","severity","lin","R","G","daltonizeDeutan","alpha","steps","X","Y","simulateLin","Sx","err","correctForDeutan","strength","hslToRgb","hue2rgb","ColorWheel","colorVisionSettings","canvasRef","useRef","selectedColor","setSelectedColor","useState","effectEnabled","setEffectEnabled","colorData","setColorData","isInitialized","setIsInitialized","ripples","setRipples","particles","setParticles","calculateColorData","useCallback","canvas","size","centerX","centerY","baseRadius","ringRadii","circleSizes","newColorData","ring","radius","circleSize","lightness","saturation","hue","angle","originalColor","finalRgb","originalRgb","preCorrection","finalColor","centerCircleSize","hexToRgb","hex","result","rgbToHsl","max","min","apply3DLighting","ctx","colorInfo","intensity","baseRgb","rgbString","match","gradient","pinkIntensity","blueIntensity","pinkLight","blueLight","applyDepthEffect","dist","maxDist","distanceFactor","saturationReduction","lightnessIncrease","hsl","adjustedRgb","adjustedColor","sizeMultiplier","applySpecialEffect","specialEffect","finalSize","skipDrawing","drawMunkerBackgroundStripes","stripeWidth","stripePattern","bgColor","drawMunkerForegroundStripes","fgColor","drawGlitchEffect","offset","smallOffset","drawColorWheel","effectResult","useEffect","startRippleEffect","color","newRipple","prev","startParticleEffect","newParticles","speed","particleColor","particleSize","handleCanvasClick","event","rect","clickX","clickY","scaleX","scaleY","canvasX","canvasY","nearestColor","minDistance","distance","animateEffects","currentTime","easeOutCubic","ripple","progress","startRadius","endRadius","easedProgress","particle","newX","newY","newLife","drawEffects","lineWidth","animationFrameRef","animationLoop","jsxs","jsx","ColorCircles","Fragment","clamp","value","ColorAdjuster","onColorVisionSettingsChange","handleSimulationToggle","handleSimulationTypeChange","type","handleSimulationSeverityChange","handleCorrectionToggle","handleCorrectionTypeChange","handleCorrectionStrengthChange","handleSpecialEffectToggle","handleSpecialEffectTypeChange","handleSpecialEffectIntensityChange","_a","newPattern","processImageData","imageData","onProgress","totalPixels","batchSize","processedPixels","actuallyProcessed","endIndex","transformedRgb","resolve","loadImageToCanvas","file","maxWidth","maxHeight","reject","img","width","height","ratio","drawImageDataToCanvas","downloadCanvasAsImage","filename","format","quality","blob","url","formatFileSize","bytes","sizes","validateImageFile","maxSize","ImageUploader","onImageLoad","processingState","disabled","dragOver","setDragOver","handleFileSelect","validationError","imageInfo","handleFileInput","handleDrop","handleDragOver","handleDragLeave","ImageViewer","onProcessingStateChange","originalCanvasRef","processedCanvasRef","viewMode","setViewMode","originalImageData","setOriginalImageData","processedImageData","setProcessedImageData","error","timeoutId","processed","handleDownload","CameraCapture","videoRef","cameraConfig","setCameraConfig","devices","setDevices","stream","setStream","isProcessingFrame","setIsProcessingFrame","videoDevices","device","toggleCamera","track","constraints","mediaStream","errorMessage","captureAndProcess","video","originalCanvas","processedCanvas","capturePhoto","AboutModal","isOpen","onClose","activeSection","renderContent","ColorWheelIcon","className","style","iconSize","App","setColorVisionSettings","currentTab","setCurrentTab","showModal","setShowModal","modalSection","setModalSection","setImageInfo","setProcessingState","windowWidth","setWindowWidth","handleProcessingStateChange","isProcessing","handleResize","savedColorVisionSettings","parsed","openModal","section","closeModal","ReactDOM","React","registration","registrationError"],"mappings":"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","x_google_ignoreList":[0,1,2]}